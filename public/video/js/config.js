window.lib=window.lib||{};window.lib.version=window.lib.version||"1.0";window.lib.update=window.lib.update||"2011/4/12";window.lib.runTime=window.lib.runTime||0;window.lib.runTime++;window.qiyi={};lib.swf=lib.swf||{};lib.getDomain=function(){var i=2;var n=window.location.hostname.split(".");n=n.slice(n.length-i);return n.join(".")};lib.SITE_DOMAIN=lib.getDomain();lib.PROJECT_NAME="qiyi";lib.PROJECT_LOGIN_COMPONENT=function(){};lib.PROJECT_LOGOUT_ACTION;lib.TIPS_ICON_NOTICE="http://www.qiyipic.com/common/fix/passport_images/success.gif";lib.TIPS_ICON_ALERT="";lib.TIPS_ICON_CONFIRM="http://www.qiyipic.com/common/fix/passport_images/warning.gif";lib.swf.canComment=function(){return info&&info.data&&!!info.data.qitanId};lib.swf.scroll2qitan=function(){if($("#j-gui-qitan")){try{lib.component.scrollTo($("#j-gui-qitan")[0],0)}catch(i){}}else{if(info&&info.data&&!!info.data.qitanId){(function(){var i=info.data.qitanId.charAt(0);var n="";switch(i){case"1":n="m/";break;case"2":n="s/";break;case"3":n="t/";break;case"6":n="r/";break}if(n){window.open("http://t.qiyi.com/"+n+info.data.qitanId)}})()}}return true};if(window.location.hostname=="search.video.qiyi.com"){window.location.href="http://search.video.iqiyi.com"+window.location.pathname}window.lib=window.lib||{version:"1.0",update:"2011/4/12"};window.onerror=function(){return true};lib.kit={util:{}};lib.swf=lib.swf||{};lib.flash={};lib.ad={};lib.action={};lib.model={};lib.view={};lib.tpl={};lib.msg={};lib.temp={};lib.SITE_PROTOCOL=window.location.protocol+"//";lib.PROJECT_DEBUG=false;lib.PROJECT_VERSION="20170712102242";lib.developer="zhangdan";lib.PROJECT_BASE_PATH=lib.SITE_PROTOCOL+"static.iqiyi.com/js/l/"+lib.PROJECT_NAME+"/";lib._PAGE_START_TIME=(new Date).getTime();lib.WMODE=lib.SAFARI||lib.IE||lib.CHROME&&lib.winXP?"Opaque":"window";lib.swf.scroll2qitan=function(){if($("#j-gui-qitan")){try{lib._PAGE_EVENT.fire({type:"page_setLight",data:{open:"true"}});lib.component.scrollTo($("#j-gui-qitan")[0],0)}catch(i){}}else{if(info&&info.data&&!!info.data.qitanId){(function(){var i=info.data.qitanId.charAt(0);var t="";switch(i){case"1":t="m/";break;case"2":t="s/";break;case"3":t="t/";break;case"6":t="r/";break}if(t){window.open("http://t.qiyi.com/"+t+info.data.qitanId)}})()}}return true};(function(i,t){var e=function(t,e){t=(t||"").toLowerCase();if(lib.kit.slog){setTimeout(function(){lib.kit.slog.log({type:"piaoshhtestmayttf",job:t,des:"findpagebyjob",url:i.location.href,entry:e,prj:lib.PROJECT_NAME||""},"http://msg.71.am/tmpstats.gif")},0)}};var o=lib.PROJECT_NAME,s=lib.PROJECT_VERSION,a=lib.PROJECT_DEBUG;if(a){if(i.console){console.noADLog=console.log;console.log=function(){}}lib.log=function(t){if(i.console){console.noADLog(t)}else{if(lib.kit.$trace)lib.kit.$trace(""+t)}}}else{lib.log=function(){return}}lib.clearLog=function(i,t,e){var o;i=i||"";t=t||"0xffffff";e=e||"8BFGU1Q6CKK";try{o=lib.action.ClearSwf.get()}catch(s){}if(o&&o.writeLog){o.writeLog(e,i,t)}};__loadMainJs=function(t){if(i.__LT__){__LT__.j["base"]=new Date;__LT__.j["job"]=__LT__.j["base"]}if(a){lib.PROJECT_BASE_PATH=lib.PROJECT_BASE_PATH.replace(/js\/l/gi,"js");document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+'base.js"></script>');if(t)document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+"jobs/"+t.toLowerCase()+'.js"></script>');return}document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+'/base.js"></script>');if(t){document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+"/jobs/"+t.toLowerCase()+'.js"></script>');e(t,"__loadMainJs")}};__loadNewMainJs=function(t){if(i.__LT__){__LT__.j["newbase"]=new Date;__LT__.j["job"]=__LT__.j["newbase"]}if(a){lib.PROJECT_BASE_PATH=lib.PROJECT_BASE_PATH.replace(/js\/l/gi,"js");document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+'newbase.js"></script>');if(t)document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+"jobs/"+t.toLowerCase()+'.js"></script>');return}document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+'/newbase.js"></script>');if(t){document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+"/jobs/"+t.toLowerCase()+'.js"></script>');e(t,"__loadNewMainJs")}};__loadSingleJs=function(i){if(a){lib.PROJECT_BASE_PATH=lib.PROJECT_BASE_PATH.replace(/js\/l/gi,"js");if(i)document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+"/jobs/"+i.toLowerCase()+'.js"></script>');return}if(i){document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+"/jobs/"+i.toLowerCase()+'.js"></script>');e(i,"__loadSingleJs")}};__loadCompatibleMainJs=function(t){if(i.__LT__){__LT__.j["base"]=new Date;__LT__.j["job"]=__LT__.j["base"]}if(a){lib.PROJECT_BASE_PATH=lib.PROJECT_BASE_PATH.replace(/js\/l/gi,"js");document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+'compatiblebase.js"></script>');if(t)document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+"jobs/"+t.toLowerCase()+'.js"></script>');return}document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+'/compatiblebase.js"></script>');if(t){document.write('<script type="text/javascript" src="'+lib.PROJECT_BASE_PATH+s+"/jobs/"+t.toLowerCase()+'.js"></script>');e(t,"__loadCompatibleMainJs")}};if(lib.SITE_DOMAIN&&(lib.SITE_DOMAIN=="qiyi.com"||lib.SITE_DOMAIN=="iqiyi.com"||lib.SITE_DOMAIN=="pps.tv")){try{document.domain=lib.SITE_DOMAIN}catch(n){}}})(this);Object.extend=function(e,t){for(var i in t){e[i]=t[i]}return e};$reg=function(e,t){var i=e.split("."),r=window;while(i.length>0){var n=i.shift();if(typeof r[n]=="undefined"){r[n]={}}r=r[n]}t()};var Class={create:function(){var e=function(){this.initialize.apply(this,arguments)};for(var t=0,i=arguments.length,r;t<i;t++){r=arguments[t];if(r==null)continue;Object.extend(e.prototype,r)}return e}};Object.extend(lib,{guid:1,each:function(e,t){if(e.constructor==Array){for(var i=0,r=e.length;i<r;i++){if(t(e[i],i)===false)return}}else if(e.constructor==Object){for(var n in e){if(t(e[n],n)===false)return}}},fixEvent:function(e){e=window.event||e;var t="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which type".split(" ");var i=e;var r={};for(var n=t.length,a;n;){a=t[--n];r[a]=i[a]}if(!r.target){r.target=r.srcElement||document}if(r.target.nodeType===3){r.target=r.target.parentNode}r.clientX=e.clientX-document.documentElement.clientLeft-document.body.clientLeft;r.clientY=e.clientY-document.documentElement.clientTop-document.body.clientTop;if(r.pageX==null&&r.clientX!=null){var s=document.documentElement,l=document.body;r.pageX=r.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0);r.pageY=r.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}if(!r.which&&r.button!==undefined){r.which=r.button&1?1:r.button&2?3:r.button&4?2:0}if(!r.relatedTarget&&r.fromElement){r.relatedTarget=r.fromElement===r.target?r.toElement:r.fromElement}return r},isNative:function(e){return!!e&&(/\{\s*\[native code\]\s*\}/.test(String(e))||/\{\s*\/\* source code not available \*\/\s*\}/.test(String(e)))}});lib.Element=Class.create({initialize:function(e){this._els=e;Array.prototype.push.apply(this,this._els);this._events={}}});Object.extend(lib.Element.prototype,{length:0,get:function(e){return this._els[e]},getAll:function(){return this._els},each:function(e){for(var t=0,i=this._els.length;t<i;t++){e(lib.$(this._els[t]),t)}},html:function(){var e=this._els[0],t="",i="";if(!e){return}if(arguments.length==1){e.innerHTML=arguments[0];return this}else if(arguments.length==2){i=arguments[0];t=arguments[1];if(e.insertAdjacentHTML){e.insertAdjacentHTML(i,t)}else{var r=null,n=e.ownerDocument.createRange();switch(String(i).toLowerCase()){case"beforebegin":n.setStartBefore(e);r=n.createContextualFragment(t);e.parentNode.insertBefore(r,e);break;case"afterbegin":n.selectNodeContents(e);n.collapse(true);r=n.createContextualFragment(t);e.insertBefore(r,e.firstChild);break;case"beforeend":n.selectNodeContents(e);n.collapse(false);r=n.createContextualFragment(t);e.appendChild(r);break;case"afterend":n.setStartAfter(e);r=n.createContextualFragment(t);e.parentNode.insertBefore(r,e.nextSibling);break}}}return e.innerHTML},load:function(e,t){var i=this._els[0];if(!i){return}t=t||{};lib.net.Ajax.text(e,{success:function(e){i.innerHTML=t.success&&t.success(e)||e},failure:function(){if(t.failure){i.innerHTML=t.failure()}}})},parent:function(e){var t=this._els[0];if(!t){return}if(!e){return lib.$(t.parentNode)}else{if(t.nodeName.toLowerCase()==e){return lib.$(t)}else{this._els[0]=t.parentNode;return this.parent(e)}}},attr:function(e,t){if(typeof t!="undefined"&&t!=null){lib.each(this._els,function(i,r){switch(e){case"class":i.className=t;break;case"style":i.style.cssText=t;break;default:i.setAttribute(e,t)}});return this}else{switch(e){case"class":return this._els[0].className;case"style":return this._els[0].style.cssText;default:return this._els[0].getAttribute(e)}}},removeAttr:function(e){lib.each(this._els,function(t,i){t.removeAttribute(e)});return this},pos:function(e){if(e){if("left"in e)this._els[0].style.left=e.left+"px";if("top"in e)this._els[0].style.top=e.top+"px";if("right"in e)this._els[0].style.right=e.right+"px";if("bottom"in e)this._els[0].style.bottom=e.bottom+"px"}else{return lib.box.getPosition(this._els[0])}},box:function(){var e=this._els[0],t=this.pos();t.width=e.offsetWidth;t.height=e.offsetHeight;t.bottom=t.top+t.height;t.right=t.left+t.width;return t},val:function(e){var t=this._els[0],i=null;if(e!=undefined){t.value=e;return this}else{switch(t.tagName.toLowerCase()){case"input":case"textarea":i=t.value;return i;break;case"select":var r=t.selectedIndex,n=t.options.length;if(n>0){i=t.options[r>-1?r:0].value}break;default:var a=t.getAttribute("data-value");if(a){i=a}break}return i}},addClass:function(e){lib.each(this._els,function(t){var i=t.className.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ").split(" "),r=i.indexOf(e);if(r==-1){i.push(e);t.className=i.join(" ")}});return this},removeClass:function(e){lib.each(this._els,function(t){var i=t.className.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ").split(" "),r=i.indexOf(e);if(r>-1){i.splice(r,1);t.className=i.join(" ")}}.bind(this));return this},hasClass:function(e){var t=this._els[0].className.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ").split(" ");return t.include(e)},css:function(e,t){if(typeof t=="undefined"){var i=this._els[0];if(e=="opacity"){if(lib.IE){var r=i.style.filter,n=r.toLowerCase();return r&&n.indexOf("opacity=")>=0?parseFloat(n.match(/opacity=([^)]*)/)[1])/100:1}else{return i.style.opacity?parseFloat(i.style.opacity):1}}else{function a(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}if(window.getComputedStyle){try{return window.getComputedStyle(i,null).getPropertyValue(a(e))}catch(s){return}}if(document.defaultView&&document.defaultView.getComputedStyle){var l=document.defaultView.getComputedStyle(i,null);if(l)return l.getPropertyValue(a(e));if(e=="display")return"none"}if(i.currentStyle){return i.currentStyle[e]}return i.style[e]}}else{this.each(function(i){if(e=="opacity"){if(lib.IE){i[0].style.filter="Alpha(Opacity="+t*100+");";try{i[0].style.opacity=t==1?"1":""+t}catch(r){}}else{i[0].style.opacity=t==1?"1":""+t}}else{i[0].style[e]=t}});return this}},append:function(e){this._els[0].appendChild(e._els[0]);return this},elements:function(){return this._els},show:function(){lib.each(this._els,function(e){e.style.display="block"});return this},hide:function(){lib.each(this._els,function(e){e.style.display="none"});return this},focus:function(e){if(typeof e=="function")lib.Event.on(this._els[0],"focus",e);else this._els[0].focus();return this},blur:function(e){if(typeof e=="function")lib.Event.on(this._els[0],"blur",e);else this._els[0].blur();return this},down:function(e){return lib.$(e,this._els[0])},on:function(e,t){lib.each(this._els,function(i){if(!i._events){i._events={}}if(!lib.IE&&(e=="mouseleave"||e=="mouseenter")){e=e=="mouseleave"?"mouseout":"mouseover";var r=t;t=function(e){var t=e.relatedTarget,i=this,n;if(t==null){n=true}else if(!t){n=false}else{n=t!=i&&!lib.$(i).contains(t)}if(n){r.apply(this,arguments)}}}if(!i._events[e]){i._events[e]=[]}if(!t.guid){t.guid=lib.guid++}var n=t._scopeApplied?t:t.bindEvent(i);n.guid=t.guid;n.handler=t;i._events[e].push(n);lib.Event.on(i,e,n)});return this},un:function(e,t){var i=arguments;lib.each(this._els,function(r){if(!lib.IE&&(e=="mouseleave"||e=="mouseenter")){e=e=="mouseleave"?"mouseout":"mouseover"}var n=r._events,a,s=0,l,o;if(!n){return}a=n[e];if(!a){return}if(i.length===1){for(l=a.length;s<l;s++){lib.$(r).un(e,a[0].handler)}return}if(!t){return}for(;s<a.length;s++){o=a[s];if(t.guid===o.guid){a.splice(s--,1);lib.Event.un(r,e,o);return}}});return this},_delegateList:[],_getDlgParent:function(e){if(!e)return null;return e.getAttribute&&(!!e.getAttribute("j-delegate")||!!e.getAttribute("j-dlg"))?e:this._getDlgParent(e.parentNode)},delegate:function(e,t,i){if(!e)return;t=t||function(){};i=i||"click";var r=this;var n=function(i){i=window.event||i;var n=i.target||i.srcElement,a=n.getAttribute("j-delegate")||n.getAttribute("j-dlg");if(a&&a==e){t({target:n,event:i});return}var s=n.getAttribute("j-dlgbubble");if(s===null)return;n=r._getDlgParent(n);a=n&&(n.getAttribute("j-delegate")||n.getAttribute("j-dlg"));if(n&&a&&a==e){t({target:n,event:i})}};this._delegateList.push([t,n]);lib.$(this._els[0]).on(i,n);return this},prev:function(){var e=this._els[0];if(e&&e.previousElementSibling){return e.previousElementSibling}do{e=e.previousSibling}while(e&&e.nodeType!=1);return e},next:function(){var e=this._els[0];if(e&&e.nextElementSibling){return e.nextElementSibling}do{e=e.nextSibling}while(e&&e.nodeType!=1);return e},first:function(){var e=this._els[0];e=e.firstChild;while(e.nodeType!=1){e=e.nextSibling}return lib.$(e)},last:function(){var e=this._els[0];e=e.lastChild;while(e.nodeType!=1){e=e.previousSibling}return lib.$(e)},children:function(){var e=this._els[0];var t=[];e=e.firstChild;do{if(e.nodeType==1){t.push(e)}e=e.nextSibling}while(e);return new lib.Element(t)},undelegate:function(e,t,i){var r=null,i=i||"click";var n=this._delegateList,a=n.length;for(var s=0;s<a;s++){if(n[s][0]===t){r=n[s][1]}}if(!r)return;lib.$(this._els[0]).un(i,r)},remove:function(){this._els.each(function(e){if(e.parentNode)e.parentNode.removeChild(e)})},contains:function(e){e=lib.$(e);if(this._els[0].contains){return this._els[0].contains(e._els[0])}else if(this._els[0].compareDocumentPosition){return this._els[0].compareDocumentPosition(e._els[0])==20}else{var t=false,i=e._els[0];while(i.parentNode!=null){if(i.parentNode===this._els[0]){t=true;break}i=i.parentNode}return t}},fixPostion:function(){var e=this.box().bottom-lib.box.getViewportHeight();var t=lib.box.getPageScrollTop();if(t<e||t>this.box().top){window.scrollTo(0,e)}}});lib.Element.create=function(e,t){var i=new lib.Element([document.createElement(e)]);return i};lib.$=function(e,t){if(e===null)return null;if(typeof e!="string"){if(e.attr){if(!e._els[0]){return null}return e}return new lib.Element([e])}var i=lib.find(e,t);if(i&&i.length>0){return new lib.Element(i)}return null};if(!lib.NO_CONFLICT)window.$=lib.$;lib.Template=Class.create({initialize:function(e){this.template=e+"";this.pattern={left:"${",right:"}"};this.regPattern=/(?:^|.|\r|\n)?(\$\{(.*?)\})/g},evaluate:function(e){var t="";if(typeof e=="object"){var i=this;t=this.template.replace(this.regPattern,function(t,r,n){var a=t.split(i.pattern.left)[0];if(a&&a=="\\"){return r}if(e[n]!=undefined){return a+e[n]}else{return a}})}return t}});lib.TemplateNew=Class.create({initialize:function(e,t){this.template=e+"";this.filter="\\";this._isNesting=/([\s\S])?\$[^{]*?\{(?:(?![{}]).|\{(?:(?![{}]).)*\})*\}/;this._regPattern=/([\s\S]?)\$(\w*){((?:(?:\$\w*){(?:(?:\$\w*)?{(?:(?:\$\w*)?{(?:(?:\$\w*)?{(?:(?:\$\w*)?{(?:(?:\$\w*)?{[^{}]*}|[^{}])*}|[^{}])*}|[^{}])*}|[^{}])*}|[^{}])*}|[^{}])*)?}/g;this._funs={};this._tmp_cache={};this.params={};this.self_params={};if(t){for(var i in t){if(t.hasOwnProperty(i)){if(typeof t[i]=="function"){this._funs[i]=t[i]}else{this.self_params[i]=t[i]}}}}},evaluate:function(obj,opt){var _template="";if(typeof obj=="object"){this._tmp_cache={};this.params=obj;obj&&Object.extend(this.params,this.self_params);obj&&Object.extend(this.params,opt);var _this=this;_template=this.template.replace(this._regPattern,function(all,filter,name,content){if(new RegExp("^\\"+_this.filter,"").test(all)){return all.split(""+_this.filter)[1]}if(_this._isNesting.test(content)){content=content.replace(_this._regPattern,arguments.callee)}var args=content?content.split(","):[];for(var cat=0,len=args.length;cat<len;cat++){args[cat]=_this.trim(args[cat])}switch(name){case"":return filter+_this.get(args[0]);case"trim":if(len==2&&args[1]&&args[1].toLowerCase()=="html"){var d=_this.get(args[0]);return filter+(d?_this.trimHTML(d):"")}else{d=_this.get(args[0]);return filter+(d?_this.trim(d):"")}case"encode":var e=_this.get(args[0]);return filter+(e&&_this.encode(e));case"time":if(!/\d*/g.test(args[0])){throw new Error("error(lib.TemplateNew.evaluate): time format is incorrect")}var ti=_this.get(args[0])||0;return filter+(ti?_this.time_format(ti):"");case"date":if(!args[1]){throw new Error("error(lib.TemplateNew.evaluate): date format argument[1] is null")}var d=_this.get(args[0]);if(!/\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/g.test(d)){throw new Error("error(lib.TemplateNew.evaluate): date format is incorrect")}return filter+(d?_this.date_format(d,args[1]):"");case"evalstr":var ev;try{ev=_this.get(args[0])}catch(err){throw new Error("error(lib.TemplateNew.evaluate): evalstr error")}return filter+eval(ev);case"cache":if(obj[args[args.length-1]]){throw new Error("error(lib.TemplateNew.evaluate): cache key the same with params key is not allowed")}var cachevalue=args.slice(0,args.length-1).join(",");obj[cachevalue]&&(_this._tmp_cache[args[args.length-1]]=obj[cachevalue])||cachevalue&&(_this._tmp_cache[args[args.length-1]]=cachevalue);return filter;case"fixed":var f=_this.get(args[0]);if(args[1]){return filter+(f&&_this.fixed(f,args[1])||"")}else{return filter+f}case"divide":var di=_this.get(args[0]);return filter+(di&&_this.divide(di));case"img":var im=_this.get(args[0]);return filter+im.setImgSize(args[1]);case"arr":var ar=args.slice(0,args.length-1).join();var ar=/\[[^\]]*\]/.test(ar)?ar:_this.get(args[0]);if(typeof ar=="string"){try{ar=eval("("+ar+")")}catch(err){throw new Error("error(lib.TemplateNew.evaluate): array format error")}}var idx=args[args.length-1]?args[args.length-1]:0;return filter+(ar[idx]||"");case"obj":var ob=args.slice(0,args.length-1).join();var ob=/{[^}]*}/.test(ob)?ob:_this.get(args[0]);if(typeof ob=="string"){try{ob=eval("("+ob+")")}catch(err){throw new Error("error(lib.TemplateNew.evaluate): object format error")}}var key=args[1];return filter+(key&&ob[key]||"");case"pick":try{switch(len){case 2:var p=_this.get(args[0]);return filter+eval(p+"? '"+args[1]+"' : ''");case 3:p=_this.get(args[0]);return filter+eval(p+"? '"+args[1]+"':'"+args[2]+"'");case 4:p=_this.get(args[0]);return filter+(p?p==args[1]?args[2]:args[3]:"");default:throw new Error("error(lib.TemplateNew.evaluate): the parameter num is incorrect")}}catch(err){switch(len){case 2:var p=_this.get(args[0]);return filter+eval("'"+p+"'? '"+args[1]+"' : ''");case 3:p=_this.get(args[0]);return filter+eval("'"+p+"'? '"+args[1]+"':'"+args[2]+"'");default:throw new Error("error(lib.TemplateNew.evaluate): the parameter num is incorrect")}}default:if(/^f_/.test(name)){var f_name=name&&name.split("f_")[1];if(!(f_name&&_this._funs[f_name])){throw new Error("error(lib.TemplateNew.evaluate): function "+f_name+" is not exists")}return filter+_this._funs[f_name].apply(_this,args)}}})}return _template},get:function(e){if(e in this.params)return this.params[e];if(e in this._tmp_cache)return this._tmp_cache[e];return e},divide:function(e){return e.divideNumber()},encode:function(e){return encodeURIComponent(e)},trim:function(e){return e.trim()},trimHTML:function(e){return e.trimHtml()},fixed:function(e,t){return e.trancate(t)},date_format:function(e,t){var i=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/.exec(e);var r=i[1],n=i[2],a=i[3],s=i[4],l=i[5],o=i[6];t=t||"hh:mm:ss";/ss/.test(t)&&(t=t.replace(/ss/,o)),/mm/.test(t)&&(t=t.replace(/mm/,l)),/hh/.test(t)&&(t=t.replace(/hh/,s)),/MM/.test(t)&&(t=t.replace(/MM/,n)),/DD/.test(t)&&(t=t.replace(/DD/,a)),/YYYY/.test(t)&&(t=t.replace(/YYYY/,r)),/YY/.test(t)&&(t=t.replace(/YY/,r.substring(2)));return t},time_format:function(e){var t=Math.floor(e/60),i=e%60;if(i<10){i="0"+i}if(t>60){var r=Math.floor(t/60);t=t%60;if(r<10){r="0"+r}if(t<10){t="0"+t}return r+":"+t+":"+i}else{if(t<10){t="0"+t}return t+":"+i}}});lib.storage=Class.create({initialize:function(){},opt:function(e,t){this.userData=this.userDataOpt(e,t);this.cookieData=this.cookieDataOpt(e,t);this.localData=this.localDataOpt(e,t);this.globalData=this.globalDataOpt(e,t);this.sessionData=this.sessionDataOpt(e,t);if(t)return;return this.userData||this.cookieData||this.localData||this.globalData||this.sessionData},userDataOpt:function(e,t){try{var i=this.createElem("div","userdata_el",1);i.style.behavior="url(#default#userData)";if(typeof t!="undefined"){i.setAttribute(e,t);i.save(e)}else{i.load(e);return i.getAttribute(e)}}catch(r){}},removeUserData:function(e){try{var t=this.createElem("div","userdata_el",1);t.style.behavior="url(#default#userData)";t.load(e);t.expires=new Date(315532799e3).toUTCString();t.save(e)}catch(i){}},cookieDataOpt:function(e,t){if(typeof t!="undefined"){document.cookie=e+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/";document.cookie=e+"="+t+"; expires=Tue, 31 Dec 2030 00:00:00 UTC; path=/"}else return this.getFromStr(e,document.cookie)},removeCookieData:function(e){document.cookie=e+"=; expires=Mon, 20 Sep 2010 00:00:00 UTC; path=/"},localDataOpt:function(e,t){try{if(window.localStorage){if(typeof t!="undefined")localStorage.setItem(e,t);else return localStorage.getItem(e)}}catch(i){}},globalDataOpt:function(name,value){if(window.globalStorage){var host=this.getHost();try{if(typeof value!="undefined")eval("globalStorage[host]."+name+" = value");else return eval("globalStorage[host]."+name)}catch(e){}}},sessionDataOpt:function(e,t){try{if(window.sessionStorage){if(typeof t!="undefined")sessionStorage.setItem(e,t);else return sessionStorage.getItem(e)}}catch(i){}},getFromStr:function(e,t){if(typeof t!="string")return;var i=e+"=";var r=t.split(/[;&]/);for(var n=0;n<r.length;n++){var a=r[n];while(a.charAt(0)==" ")a=a.substring(1,a.length);if(a.indexOf(i)==0)return a.substring(i.length,a.length)}},getHost:function(){var e=document.location.host;if(e.indexOf("www.")==0)e=e.replace("www.","");return e},createElem:function(e,t,i){var r;if(typeof t!="undefined"&&document.getElementById(t))r=document.getElementById(t);else r=document.createElement(e);r.style.visibility="hidden";r.style.position="absolute";if(t)r.setAttribute("id",t);if(i)document.body.appendChild(r);return r}});lib.$url=function(e){var t=e.replace(/[\s\S]+.html(?:\?([^#]+))?(?:#([\s\S]+))?/g,function(){return arguments[1]&&arguments[2]?arguments[1]+"&"+arguments[2]:arguments[1]||arguments[2]});if(arguments.length==2&&arguments[1].sort){var i=arguments[1]}else{i=[].slice.call(arguments,1)}var r=[];var n,a,s;n={};s=new RegExp("(&?)(("+i.join("|")+")(=?)([^&#?]*))","g");while((a=s.exec(t))!=null){if(a[2].indexOf("=")==-1){var l=a[3];var o=a[5];r.push(a[4]?a[5]:a[2]);l&&(n[l]=o)}else{var c=a[2].split("=");var l=c[0];var o=c[1];r.push(o);l&&(n[l]=o)}}if(r.length==0)return;n["params"]=r;return n};lib.$tmp=function(e,t){var i=new lib.TemplateNew(e);var r=[];for(var n=0,a=t.length;n<a;n++){r.push(i.evaluate(t[n]))}return r.join("")};lib.Event={on:function(e,t,i){if(!e||!t||!i)return this;if(e.addEventListener){e.addEventListener(t,i,false)}else if(e.attachEvent){e.attachEvent("on"+t,i)}else{lib.Event.manager.add(t,eventHandle)}return this},unbind:function(e,t,i){for(var r=0,n=i.length;r<n;r++){this.un(e,t,i[r])}e["on"+t]=null;return this},un:function(e,t,i){if(!e||!t)return this;if(e.removeEventListener){if(t==="mouseleave"){t="mouseout"}else if(t==="mouseenter"){t="mouseover"}e.removeEventListener(t,i,false)}else if(e.detachEvent){e.detachEvent("on"+t,i)}else{lib.Event.manager.del(t,i)}},stop:function(e){lib.Event.stopPropagation(e);lib.Event.preventDefault(e)},stopPropagation:function(e){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation()}},preventDefault:function(e){try{e.returnValue=false;if(e.preventDefault){e.preventDefault()}}catch(e){}},getEvent:function(){if(event)return event;var e=arguments.callee.caller;var t;var i=0;while(e!=null&&i<40){t=e.arguments[0];if(t&&(t.constructor==Event||t.constructor==MouseEvent)){return t}i++;e=e.caller}return t}};lib.go=function(e){location.href=e};lib.base=function(e,t,i){var r=arguments.callee.caller;if(r.superClass_){return r.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1))}var n=Array.prototype.slice.call(arguments,2);var a=false;for(var s=e.constructor;s;s=s.superClass_&&s.superClass_.constructor){if(s.prototype[t]===r){a=true}else if(a){return s.prototype[t].apply(e,n)}}if(e[t]===r){return e.constructor.prototype[t].apply(e,n)}else{throw Error("lib.base called from a method of one name "+"to a method of a different name")}};lib.inherits=function(e,t){function i(){}i.prototype=t.prototype;e.superClass_=t.prototype;e.prototype=new i;e.prototype.constructor=e};Object.extend(lib,{Class:function(e,t){if(arguments[0]&&typeof arguments[0]=="object"){return Class.create.apply(null,arguments)}var r=t.ns||lib;if(r[e])return r[e];var i=t.extend||lib.Object;var n=function(){};n.prototype=i.prototype;var a=t.construct||function(){};var s=t.properties||{};var l=t.methods||{};var o=t.statics||{};var c=new n;for(var u in c){if(c.hasOwnProperty(u)){delete c[u]}}for(var u in s){c[u]=s[u]}for(var u in l){c[u]=l[u];c[u]._construct=a}c.constructor=a;c.superclass=i;c.__NAME__=e;a.prototype=c;for(var u in o){a[u]=o[u]}r[e]=a;return a},abstractMethod:function(){throw"not implemented"},emptyMethod:function(){},reg:$reg});lib.Class("Object",{extend:Object,methods:{callsuper:function(e){if(typeof e=="string"){var t=arguments.callee.caller._construct;var r=t.prototype.superclass;var i=[];if(arguments.length>1){for(var n=1;n<arguments.length;n++){i.push(arguments[n])}}return r.prototype[e].apply(this,i)}else{return arguments.callee.caller.prototype.superclass.apply(this,arguments)}}}});Object.extend(Function.prototype,{bind:function(){var e=this,t=arguments[0],r=[];for(var i=1,n=arguments.length;i<n;i++){r.push(arguments[i])}return function(){var i=r.concat();for(var n=0,a=arguments.length;n<a;n++){i.push(arguments[n])}return e.apply(t,i)}},bindEvent:function(){var e=this,t=arguments[0],r=[];for(var i=1,n=arguments.length;i<n;i++){r.push(arguments[i])}return function(i){var n=r.concat();n.unshift(i||window.event);return e.apply(t,n)}},method:function(e,t){this[e]=t;return this},inherits:function(e){function t(){}t.prototype=e.prototype;this.superClass_=e.prototype;this.prototype=new t;this.prototype.constructor=this}});Object.extend(lib,function(){var e={};var t=navigator.userAgent.toLowerCase();var r=navigator.plugins;e.IE=/msie/.test(t);e.OPERA=/opera/.test(t);e.MOZ=/gecko/.test(t);e.IE6=/msie 6/.test(t);e.IE7=/msie 7/.test(t);e.IE8=/msie 8/.test(t);e.IE9=/msie 9/.test(t);e.SAFARI=/safari/.test(t)&&!/chrome/.test(t);e.WEBKIT=/webkit/.test(t);e.winXP=/windows nt 5.1/.test(t);e.winVista=/windows nt 6.0/.test(t);e.CHROME=/chrome/.test(t);e.iphone=/iphone os/.test(t);e.ipod=/ipod\;/.test(t);e.android=/android/.test(t);e.iphone4=/iphone os [456]_/.test(t);e.realIpad=/ipad/.test(t);e.lePad=/lepad_hls/.test(t);e.Mac=/macintosh/.test(t);e.ipad=e.realIpad||e.iphone||e.lePad;e.noFlashAndroid=e.WEBKIT&&e.android&&(!r||!r["Shockwave Flash"]);e.TT=/tencenttraveler/.test(t);e.$360=/360se/.test(t);e.ff=/firefox/.test(t);e.ff4=/firefox\/4/.test(t);e.Maxthon=false;try{e.html5Video=!!document.createElement("video").play}catch(i){e.html5Video=false}try{var n=window.external;e.Maxthon=n.max_version?true:false}catch(i){}lib.swf.browserVer=function(){if(e.IE6)return"IE6";if(e.IE7)return"IE7";if(e.IE8)return"IE8";if(e.IE9)return"IE9";if(e.ff)return"fireFox";if(e.CHROME)return"chrome";return"none"};e.getOS=function(){var e=navigator.userAgent;var t=navigator.platform=="Win32"||navigator.platform=="Windows";var r=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||navigator.platform=="MacIntel";if(r)return"Mac";var i=navigator.platform=="X11"&&!t&&!r;if(i)return"Unix";if(t){var n=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(n)return"Win2000";var a=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(a)return"WinXP";var s=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(s)return"Win2003";var o=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(o)return"WinVista";var l=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(l)return"Win7"}return"None"};e.getBr=function(){var e=navigator.userAgent.toLowerCase();var t=false;try{var r=window.external;t=r.max_version?true:false;if(t)return"傲游 "+r.max_version}catch(i){}if(/msie/.test(e))return e.match(/msie [\d.]+/)[0];if(/Firefox/i.test(e))return"firefox "+e.match(/firefox\/([\d.]+)/)[1];if(/360se/.test(e))return"360";if(/tencenttraveler/.test(e))return"TT";if(/chrome\/([\d.]+)/.test(e))return e.match(/chrome\/[\d.]+/);if(/safari/.test(e))return e.match(/safari\/[\d.]+/);if(/opera/.test(e))return"opera";return"非主流浏览器"};return e}());if(lib.IE6){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}lib.WMODE=lib.SAFARI||lib.IE||lib.CHROME&&lib.winXP?"Opaque":"window";lib.kit.slog={url:"http://jsmsg.video.qiyi.com/m.gif",log:function(e,t){if(t){this.url=t}else{return}if(e){var r=new Image;var i="slog_"+Math.floor(Math.random()*2147483648).toString(36);lib.kit.slog[i]=r;r.onload=r.onerror=r.onabort=function(){r.onload=r.onerror=r.onabort=null;lib.kit.slog[i]=null;delete lib.kit.slog[i];r=null};var n=[];e.t=Math.round(Math.random()*2147483647);for(var i in e){n.push(i+"="+encodeURIComponent(e[i]))}r.src=this.url+"?"+n.join("&")}}};var Url=function(e){e=e||"";this.url=e;this.query={};this.hrParam={};this.info={};this.parse()};(function(e){e.prototype={parse:function(e){if(e){this.url=e}this.parseAnchor();this.parseParam();this.parseInfo()},parseAnchor:function(){var e=this.url.match(/\#(.*)/);e=e?e[1]:null;this._anchor=e;if(e!=null){this.anchor=this.getNameValuePair(e);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var e=this.url.match(/\?([^\?]*)/);e=e?e[1]:null;if(e!=null){this.query=this.getNameValuePair(e);this.hrParam=this.getNameValuePair(e,"-");this.url=this.url.replace(/\?([^\?]*)/,"")}},parseInfo:function(){var e=/(\w+):\/\/([^\/:]+):?(\d*)((?:\/|$).*)/;var t=this.url.match(e);if(t){var r=t[1];var i=t[2];var n=t[3];var a=t[4];this.info={protocol:r,host:i,port:n,path:a}}},getNameValuePair:function(e,t){var r={};var i=t||"&";var n=new RegExp("([^"+i+"=]*)(?:=([^"+i+"]*))?","gim");e.replace(n,function(e,t,i){if(t==""){return r}r[t]=i||""});return r},getParam:function(e){return this.query[e]||""},getHrParam:function(e){return this.hrParam[e]||""},getHostname:function(){return this.info.host},clearParam:function(){this.query={}},setParam:function(e,t){if(e==null||e==""||typeof e!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[e]=t},setParams:function(e){this.query=e},serialize:function(e){var t=[];for(var r in e){if(e[r]==null||e[r]==""){t.push(r+"=")}else{t.push(r+"="+e[r])}}return t.join("&")},toString:function(){var e=this.serialize(this.query);return this.url+(e.length>0?"?"+e:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(e){return this.anchor?"#"+this.serialize(this.anchor):e?"#":""}}})(Url);$reg("lib.kit.Url",function(){lib.kit.Url=Url});lib.kit.util=lib.kit.util||{};lib.kit.util.jsLoad={};(function(){function parseParam(e,t){var r;try{if(typeof t!="undefined"){for(r in e){if(t[r]){e[r]=t[r]}}}}finally{r=null;return e}}function createScripts(e,t){processUrl(e,t);var r=e.urls;var i=document.createElement("script");i.src=r.url;i.charset=r.charset;i.onload=i.onerror=i.onreadystatechange=function(){if(i&&i.readyState&&i.readyState!="loaded"&&i.readyState!="complete"){return}t.script_loaded_num++;i.onload=i.onreadystatechange=i.onerror=null;i.src="";i.parentNode.removeChild(i);i=null};document.getElementsByTagName("head")[0].appendChild(i)}function processUrl(e,t){var r=e.urls;var i,n,a,s;if(typeof e.CACHE!="undefined"){var o=e.CACHE;n=r.url;for(i in o){if(i=="varname"){a=o[i];continue}n+=o[i]+"/"}r.url=n.toString();if(e.spliter==="0"){r.url=r.url.slice(0,-1)}}if(typeof e.GET!="undefined"){var l=new lib.kit.Url(r.url),c=e.GET;for(var i in c){if(i=="cb"){a=c[i]}l.setParam(i,encodeURIComponent(c[i]))}r.url=l.toString()}if(a){t.script_var_arr.push(a)}r.charset=e.charset||"utf-8"}function ancestor(aUrls,oOpts){var _opts={urls:[],charset:"utf-8",timeout:-1,CACHE:oOpts.CACHE,GET:oOpts.GET,spliter:"1",onSuccess:function(){},onError:function(){}};var _cfg={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};_opts.urls=typeof aUrls=="string"?{url:aUrls}:aUrls;parseParam(_opts,oOpts);createScripts(_opts,_cfg);(function(){if(_opts.noreturn==true&&_opts.onComplete==null){return}var i,data=[];if(_cfg.script_loaded_num==1){_cfg.is_loadcomplete=true;if(_opts.onSuccess!=null){for(i=0;i<_cfg.script_var_arr.length;i++){var key=_cfg.script_var_arr[i].trim(),o;if(key.indexOf(".")!=-1){o=eval(key)}else{o=window[key]}data.push(o)}if(_cfg.script_var_arr.length<2){if(typeof data[0]!="undefined"&&(!data[0].code||data[0].code=="A00000"))_opts.onSuccess(typeof data[0].data=="undefined"?data[0]:data[0].data);else{_opts.onError(data[0])}}else{if(!data.code||data.code=="A00000")_opts.onSuccess(typeof data.data=="undefined"?data:data.data);else{_opts.onError(data)}}}return}if(_cfg.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(_opts.timeout>0){setTimeout(function(){if(!_cfg.is_loadcomplete){if(_opts.onError){_opts.onError()}_cfg.is_timeout=true}},_opts.timeout)}}lib.kit.util.jsLoad.request=function(e,t){new ancestor(e,t)};var paramFormat=function(e){var t=[];if(typeof e=="object"){for(var r in e){t[t.length]=encodeURIComponent(r)+"="+encodeURIComponent(e[r])}}return t.join("&").replace(/%20/g,"+")};lib.kit.util.jsLoad.jsonp=function(e,t){var r;var i;var n;var a;var s="window.Q.__callbacks__.";var o="cb"+Math.floor(Math.random()*2147483648).toString(36);var l=function(){};t.timeout=t.timeout||1e4;t.params["callback"]=s+o;var c=function(e){if(e.clearAttributes){e.clearAttributes()}if(e&&e.parentNode){e.parentNode.removeChild(e)}e=null};var u=Q.__callbacks__;var f=t.oncomplete||l,p=t.onsuccess||l,h=t.onfailure||l,d=t.onTimeout||h||l;u[o]=function(e){if(r){clearTimeout(r)}f(e);if(e&&e.code=="A00000"){p(e)}else{h(e)}c(i);delete u[o]};n=e+(/\?/.test(e)?"&":"?")+paramFormat(t.params);i=document.createElement("script");i.type="text/javascript";if(!!t.charset){i.charset=t.charset}i.src=n;i.onerror=function(){h({code:"E00000"});c(i)};document.getElementsByTagName("head")[0].appendChild(i);r=setTimeout(function(){d({code:"E00000"});a=true;c(i)},t.timeout)}})();lib.kit.util=lib.kit.util||{};lib.kit.util.jsonp={};(function(){var e=window;var t=e.__callbacks__={};if(!window.Q||!Q.url||!Q.url.jsonToQuery){window.Q=window.Q||{};Q.url=Q.url||{};Q.url.jsonToQuery=function(e,t){var r=function(e){return Object.prototype.toString.call(e)=="[object Array]"};var i=[],n,a,s,o,l=t||function(e){return e};for(n in e){a=n;s=e[n];if(r(s)){o=s.length;while(o--){i.push(a+"="+l(s[o],a))}}else{i.push(a+"="+l(s,a))}}return i.join("&")}}var r=function(e){return RegExp("\\?").test(e)?"&":"?"};var i=function(e,t){var r=document.createElement("SCRIPT");r.setAttribute("type","text/javascript");if(t){r.setAttribute("charset",t)}r.id="js_"+(new Date).getTime();r.defer=true;r.charset=t||"utf-8";r.src=e;document.getElementsByTagName("head")[0].appendChild(r);return r};var n=function(e){if(e.clearAttributes){e.clearAttributes()}if(e&&e.parentNode){e.parentNode.removeChild(e)}e=null};var a=function(){};var s=function(e,a){var s;var o;var l;var u=Object.extend({},a.data);var c=a.timeout||1e4;var f=a.onsuccess;var p=a.onfailure;var h=a.jsonpCallback||"cb"+Math.floor(Math.random()*2147483648).toString(36);var d="callback";var m=t;var g="window.__callbacks__.";if(f){u[d]=g+h;m[h]=function(e){if(s){clearTimeout(s)}f(e);m[h]=null;n(o)};l=e+r(e)+Q.url.jsonToQuery(u,window.encodeURIComponent)}o=i(l,a.charset);s=setTimeout(function(){n(o);p()},c)};lib.kit.util.jsonp.request=s})();lib.action.html5VV=function(){lib.component=lib.component||{};lib.component.login=lib.component.login||{};lib.component.login.getUserInfo=function(){return{}};var e=lib.$("#video");var t="http://msg.71.am/vpb.gif";var r="http://msg.71.am/err.gif";var i=info.ipad?info.ipad.serverId||"":"";var n=function(){var e=3;if(lib.realIpad){e=2}if(lib.iphone){e=3}if(lib.$("#j-back2App")){e+="4"}else{e+="1"}return e}();var a={flag:"plyract",plyract:"",prgr:0,vid:info.videoId||"",aid:info.albumId||"",tvid:info.tvId||"",cid:info.ipad?info.ipad.categoryId||"":"",purl:function(e){return e.protocol+"//"+e.host+e.pathname}(window.location),pla:n,z:i,lev:e.attr("bits")||""};var o={flag:"error",errcode:"4015",tvid:info.tvId||"",cid:info.ipad?info.ipad.categoryId||"":"",pla:n,z:i,lev:e.attr("bits")||""};var s;var l=0;var u=0;var c=true;var f="suid";var p=true;var d=function(r){var i=Object.extend({},a);i.prgr=Math.round(e[0].currentTime);i.plyract="timing";i.tl=r;i.puid=lib.component.login.getUserInfo().uid||"";m(function(e){i.suid=e;lib.kit.slog.log(i,t)})};var h=function(){var r=Object.extend({},a);r.prgr=Math.round(e[0].currentTime);r.plyract="start";r.pla=n;r.puid=lib.component.login.getUserInfo().uid||"";m(function(e){r.suid=e;lib.kit.slog.log(r,t)})};var m=function(e){var t=function(e){var t;lib.kit.util.jsLoad.request("http://data.video.qiyi.com/uid",{CACHE:{varname:"uid"},onSuccess:function(r){if(r){t=r.uid;e(t)}else{t=lib.md5(+new Date+Math.round(Math.random()*2147483647)+"");e(t)}},onError:function(){e(data.uid)},is_timeout:true,timeout:2e3})};uid=lib.cookie.get(f);if(uid){e(uid)}else{t(function(t){lib.cookie.set(f,t,365*24,"/",lib.SITE_DOMAIN);e(t)})}};var g=function(t){if(c){lib.kit.slog.log({c1:"1",c2:"7290408",c3:"",c4:"",c5:"",c6:""},"http://b.scorecardresearch.com/b");h();c=false}s=setTimeout(function(){u++;if(e[0].ended||e[0].paused){clearTimeout(s);e.on("timeupdate",g);return}v();s=setTimeout(arguments.callee,1e3)},1e3);e.un("timeupdate",g)};var v=function(){switch(l){case 0:if(u==15){d(u);l++};break;case 1:if(u==60){d(u);l++};break;case 2:if(u==120){d(u);u=0}break}};var b=function(e){d(u)};var _=function(e){var t=Object.extend({},o);t.puid=lib.component.login.getUserInfo().uid||"";if(c||!p){return}m(function(e){t.suid=e;lib.kit.slog.log(t,r)})};var w=function(e){p=false};var y=function(e){p=true};if(e&&e[0].play){e.on("timeupdate",g);e.on("ended",b);e.on("waiting",_);lib._PAGE_EVENT.on("userSeeking",w);e.on("canplay",y);lib.$(window).on("beforeunload",b)}};lib.action.html5LiveVV=function(){var e=lib.$("#video");var t="http://msg.71.am/livepb.gif";var r={pl:"h5",device:lib.realIpad?"pad":"phone",lag:0};var i=false;var n;var a=120*1e3;var o=function(){if(n){if(new Date*1-n>=a){lib.kit.slog.log(r,t);n=0;r.lag=0}}else{n=new Date*1}i=true};var s=function(){if(i){r.lag++}};var l=function(){i=false};if(e&&e[0].play){e.on("timeupdate",o);e.on("waiting",s)}};var hexcase=0;var b64pad="";var chrsz=8;function hex_md5(e){return binl2hex(core_md5(str2binl(e),e.length*chrsz))}function b64_md5(e){return binl2b64(core_md5(str2binl(e),e.length*chrsz))}function str_md5(e){return binl2str(core_md5(str2binl(e),e.length*chrsz))}function hex_hmac_md5(e,t){return binl2hex(core_hmac_md5(e,t))}function b64_hmac_md5(e,t){return binl2b64(core_hmac_md5(e,t))}function str_hmac_md5(e,t){return binl2str(core_hmac_md5(e,t))}function md5_vm_test(){return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72"}function core_md5(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var r=1732584193;var i=-271733879;var n=-1732584194;var a=271733878;for(var o=0;o<e.length;o+=16){var s=r;var l=i;var c=n;var u=a;r=md5_ff(r,i,n,a,e[o+0],7,-680876936);a=md5_ff(a,r,i,n,e[o+1],12,-389564586);n=md5_ff(n,a,r,i,e[o+2],17,606105819);i=md5_ff(i,n,a,r,e[o+3],22,-1044525330);r=md5_ff(r,i,n,a,e[o+4],7,-176418897);a=md5_ff(a,r,i,n,e[o+5],12,1200080426);n=md5_ff(n,a,r,i,e[o+6],17,-1473231341);i=md5_ff(i,n,a,r,e[o+7],22,-45705983);r=md5_ff(r,i,n,a,e[o+8],7,1770035416);a=md5_ff(a,r,i,n,e[o+9],12,-1958414417);n=md5_ff(n,a,r,i,e[o+10],17,-42063);i=md5_ff(i,n,a,r,e[o+11],22,-1990404162);r=md5_ff(r,i,n,a,e[o+12],7,1804603682);a=md5_ff(a,r,i,n,e[o+13],12,-40341101);n=md5_ff(n,a,r,i,e[o+14],17,-1502002290);i=md5_ff(i,n,a,r,e[o+15],22,1236535329);r=md5_gg(r,i,n,a,e[o+1],5,-165796510);a=md5_gg(a,r,i,n,e[o+6],9,-1069501632);n=md5_gg(n,a,r,i,e[o+11],14,643717713);i=md5_gg(i,n,a,r,e[o+0],20,-373897302);r=md5_gg(r,i,n,a,e[o+5],5,-701558691);a=md5_gg(a,r,i,n,e[o+10],9,38016083);n=md5_gg(n,a,r,i,e[o+15],14,-660478335);i=md5_gg(i,n,a,r,e[o+4],20,-405537848);r=md5_gg(r,i,n,a,e[o+9],5,568446438);a=md5_gg(a,r,i,n,e[o+14],9,-1019803690);n=md5_gg(n,a,r,i,e[o+3],14,-187363961);i=md5_gg(i,n,a,r,e[o+8],20,1163531501);r=md5_gg(r,i,n,a,e[o+13],5,-1444681467);a=md5_gg(a,r,i,n,e[o+2],9,-51403784);n=md5_gg(n,a,r,i,e[o+7],14,1735328473);i=md5_gg(i,n,a,r,e[o+12],20,-1926607734);r=md5_hh(r,i,n,a,e[o+5],4,-378558);a=md5_hh(a,r,i,n,e[o+8],11,-2022574463);n=md5_hh(n,a,r,i,e[o+11],16,1839030562);i=md5_hh(i,n,a,r,e[o+14],23,-35309556);r=md5_hh(r,i,n,a,e[o+1],4,-1530992060);a=md5_hh(a,r,i,n,e[o+4],11,1272893353);n=md5_hh(n,a,r,i,e[o+7],16,-155497632);i=md5_hh(i,n,a,r,e[o+10],23,-1094730640);r=md5_hh(r,i,n,a,e[o+13],4,681279174);a=md5_hh(a,r,i,n,e[o+0],11,-358537222);n=md5_hh(n,a,r,i,e[o+3],16,-722521979);i=md5_hh(i,n,a,r,e[o+6],23,76029189);r=md5_hh(r,i,n,a,e[o+9],4,-640364487);a=md5_hh(a,r,i,n,e[o+12],11,-421815835);n=md5_hh(n,a,r,i,e[o+15],16,530742520);i=md5_hh(i,n,a,r,e[o+2],23,-995338651);r=md5_ii(r,i,n,a,e[o+0],6,-198630844);a=md5_ii(a,r,i,n,e[o+7],10,1126891415);n=md5_ii(n,a,r,i,e[o+14],15,-1416354905);i=md5_ii(i,n,a,r,e[o+5],21,-57434055);r=md5_ii(r,i,n,a,e[o+12],6,1700485571);a=md5_ii(a,r,i,n,e[o+3],10,-1894986606);n=md5_ii(n,a,r,i,e[o+10],15,-1051523);i=md5_ii(i,n,a,r,e[o+1],21,-2054922799);r=md5_ii(r,i,n,a,e[o+8],6,1873313359);a=md5_ii(a,r,i,n,e[o+15],10,-30611744);n=md5_ii(n,a,r,i,e[o+6],15,-1560198380);i=md5_ii(i,n,a,r,e[o+13],21,1309151649);r=md5_ii(r,i,n,a,e[o+4],6,-145523070);a=md5_ii(a,r,i,n,e[o+11],10,-1120210379);n=md5_ii(n,a,r,i,e[o+2],15,718787259);i=md5_ii(i,n,a,r,e[o+9],21,-343485551);r=safe_add(r,s);i=safe_add(i,l);n=safe_add(n,c);a=safe_add(a,u)}return Array(r,i,n,a)}function md5_cmn(e,t,r,i,n,a){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(i,a)),n),r)}function md5_ff(e,t,r,i,n,a,o){return md5_cmn(t&r|~t&i,e,t,n,a,o)}function md5_gg(e,t,r,i,n,a,o){return md5_cmn(t&i|r&~i,e,t,n,a,o)}function md5_hh(e,t,r,i,n,a,o){return md5_cmn(t^r^i,e,t,n,a,o)}function md5_ii(e,t,r,i,n,a,o){return md5_cmn(r^(t|~i),e,t,n,a,o)}function core_hmac_md5(e,t){var r=str2binl(e);if(r.length>16)r=core_md5(r,e.length*chrsz);var i=Array(16),n=Array(16);for(var a=0;a<16;a++){i[a]=r[a]^909522486;n[a]=r[a]^1549556828}var o=core_md5(i.concat(str2binl(t)),512+t.length*chrsz);return core_md5(n.concat(o),512+128)}function safe_add(e,t){var r=(e&65535)+(t&65535);var i=(e>>16)+(t>>16)+(r>>16);return i<<16|r&65535}function bit_rol(e,t){return e<<t|e>>>32-t}function str2binl(e){var t=Array();var r=(1<<chrsz)-1;for(var i=0;i<e.length*chrsz;i+=chrsz)t[i>>5]|=(e.charCodeAt(i/chrsz)&r)<<i%32;return t}function binl2str(e){var t="";var r=(1<<chrsz)-1;for(var i=0;i<e.length*32;i+=chrsz)t+=String.fromCharCode(e[i>>5]>>>i%32&r);return t}function binl2hex(e){var t=hexcase?"0123456789ABCDEF":"0123456789abcdef";var r="";for(var i=0;i<e.length*4;i++){r+=t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15)}return r}function binl2b64(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r="";for(var i=0;i<e.length*4;i+=3){var n=(e[i>>2]>>8*(i%4)&255)<<16|(e[i+1>>2]>>8*((i+1)%4)&255)<<8|e[i+2>>2]>>8*((i+2)%4)&255;for(var a=0;a<4;a++){if(i*8+a*6>e.length*32)r+=b64pad;else r+=t.charAt(n>>6*(3-a)&63)}}return r}var plainText="Rebellious subjects, enemies to peace,\n    Profaners of this neighbour-stained steel,--\n    Will they not hear? What, ho! you men, you beasts,\n    That quench the fire of your pernicious rage\n    With purple fountains issuing from your veins,\n    On pain of torture, from those bloody hands\n    Throw your mistemper'd weapons to the ground,\n    And hear the sentence of your moved prince.\n    Three civil brawls, bred of an airy word,\n    By thee, old Capulet, and Montague,\n    Have thrice disturb'd the quiet of our streets,\n    And made Verona's ancient citizens\n    Cast by their grave beseeming ornaments,\n    To wield old partisans, in hands as old,\n    Canker'd with peace, to part your canker'd hate:\n    If ever you disturb our streets again,\n    Your lives shall pay the forfeit of the peace.\n    For this time, all the rest depart away:\n    You Capulet; shall go along with me:\n    And, Montague, come you this afternoon,\n    To know our further pleasure in this case,\n    To old Free-town, our common judgment-place.\n    Once more, on pain of death, all men depart.";for(var i=0;i<4;i++){plainText+=plainText}var md5Output=hex_md5(plainText);lib.md5=hex_md5;window.lib=window.lib||{};lib.KEY={};Object.extend(lib.KEY,{BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,PAGEUP:33,PAGEDOWN:34,pointerX:function(e){return e.pageX||e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)},pointerY:function(e){return e.pageY||e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)}});lib.eventTarget=function(){this.handlers={}};lib.eventTarget.prototype={constructor:lib.eventTarget,on:function(e,t){if(typeof this.handlers[e]=="undefined"){this.handlers[e]=[]}this.handlers[e].push(t)},fire:function(e){if(!e.target){e.target=this}if(this.handlers[e.type]instanceof Array){var t=this.handlers[e.type];for(var r=0,i=t.length;r<i;r++){try{t[r](e)}catch(n){lib.log(n)}}}},un:function(e,t){if(this.handlers[e]instanceof Array){var r=this.handlers[e];for(var i=0,n=r.length;i<n;i++){if(r[i]===t){break}}r.splice(i,1)}}};lib._PAGE_EVENT=new lib.eventTarget;lib.swf=lib.swf||{};lib.swf.playerLoaded=function(){lib._PLAYER_LOADED_TIME=(new Date).getTime()};lib.swf.startAcc=function(){var e="startedAcc";var t=lib.cookie.get(e);if(lib.IE6||lib.IE7){if(!t){lib.cookie.set(e,1,24,"/",lib.SITE_DOMAIN);window.location.href="qiyiacc:\\StartMethod=1;WebBrowser="+lib.swf.browserVer()}}};lib.swf.error=function(e){if(lib.kit.slog){lib.kit.slog.log({flag:"flasherr_"+e})}};(function(){if(lib.runTime==1){var e=lib.swf.notice||function(){};lib.swf.notice=function(t){e(t);try{var r=JSON.parse(t)}catch(i){lib.kit.slog.log({flag:"SwfNoticeError",param:t});return}r.type="swf_"+r.type;lib._PAGE_EVENT.fire(r)}}})();var isWin=navigator.appVersion.toLowerCase().indexOf("win")!=-1?true:false;var authUrl="http://serv.vip.iqiyi.com/services/padw_auth.action";var video=lib.kit.video={controlVersion:function(){var e;var t;var r;try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");e=t.GetVariable("$version")}catch(r){}if(!e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");e="Player 3,0,18,0"}catch(r){}}if(!e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");e="Player 2,0,0,11"}catch(r){e=-1}}return(e+"").replace(/\,/g,".")},getSwfVer:function(){var e=-1;if(navigator.plugins&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var t=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var r=navigator.plugins["Shockwave Flash"+t].description;var i=r.split(" ");var a=i[2].split(".");var n=a[0];var o=a[1];var s=i[3];if(s==""){s=i[4]}if(s[0]=="d"){s=s.substring(1)}else if(s[0]=="r"){s=s.substring(1);if(s.indexOf("d")>0){s=s.substring(0,s.indexOf("d"))}}var e=n+"."+o+"."+s}}else if(navigator.userAgent.match(/webtv\/2.6/i))e=4;else if(navigator.userAgent.match(/webtv\/2.5/i))e=3;else if(navigator.userAgent.match(/webtv/i))e=2;else if(lib.IE&&isWin&&!lib.OPERA){e=this.controlVersion()}return e},html5video:function(e){if(window.Q&&Q.player&&Q.player.demandPb){Q.player.demandPb()}var t=this;this._renderVideo(e);var r="http://cache.vip.qiyi.com/ip4j/";var i=this._getVid(e);var a=this._getTvId(e);if(!i){return}var n="http://cache.m.iqiyi.com/jp/tmts/"+a+"/"+i+"/";var o=lib.ipad||lib.iphone;var s={uid:lib.net.getLoginInfo().uid||"",cupid:"",type:o?"m3u8":"mp4"};if(lib.cookie.get("QC004")==="0"){Object.extend(s,{nolimit:1})}lib.kit.util.jsonp.request(n,{data:s,onsuccess:function(r){var i={A00004:"数据不存在",A00001:"参数错误",A00010:"调用passport获取用户信息失败",A00011:"调用会员鉴权接口失败",A00013:"IP限制"};var a={A00012:"需要前端请求广告mixer接口",A00015:"会员鉴权成功",A00000:"不请求广告直接播放"};if(r.code==="A00000"){if(r.data.ds in a){r.src=r.data.m3u;t._loadHtml5video({url:r.src})}}else{var n=r.code;if(n=="A00013"){lib.$("#"+e.wrapper).html(["由于版权受限，您访问的视频只能在中国大陆范围内观看！","<br/>",'<span style="font-size:12px">',"如果您所在区域为中国大陆，",'<a href="http://www.qiyi.com/common/helpandsuggest.html?entry=banquan" target="_blank" class="fWhite">',"请告知我们","</a> 我们将尽快查找原因。"].join(""))}else{lib.$("#"+e.wrapper).html("对不起，此视频暂时不支持您的设备观看。")}lib.$("#"+e.wrapper).css("color","#fff");lib.$("#"+e.wrapper).css("font-size","16px")}},onfailure:function(){lib.$("#"+e.wrapper).html("对不起，此视频暂时不支持您的设备观看。");lib.$("#"+e.wrapper).css("color","#fff");lib.$("#"+e.wrapper).css("font-size","16px")}})},_renderVideo:function(e){e.wrapper=e.wrapper||"flashbox";var t=[];t.push('<div id="j-html5video-warrper" style="background-color:#000000;position:relative;">');t.push(['<div data-ctrl="playbar-warpper" class="ctrl-layer" style="display:none;position:absolute;z-index:1;width:'+e.width+"px;height:"+(e.height-53)+'px;">','<div data-layer="warpper" class="ctrl-layerhalf">','<div data-layer="play" class="layer-btn"><a href="#" data-ctrl="play" class="ctrlbigplay"></a></div>','<div data-layer="load" class="layer-load" style="display:none;"><img src="http://www.qiyipic.com/common/images/load.gif" />正在加载...</div>',"</div>","</div>"].join(""));t.push('<video id="video" width="'+e.width+'" height="'+e.height+'" controls="controls" x-webkit-airplay="allow"');if(typeof e.flashVars!="undefined"){var r=e.flashVars.match(/\&flvPic=(.*?)\&/g);if(r)t.push("poster = "+RegExp.$1)}t.push(">");t.push('<source src="" type="video/mp4"/>');t.push("</video>");t.push(['<div data-ctrl="ctrlbar-warpper" class="video-controlbox clearfix" style="display:none;">','<div class="ctrl-top"></div>','<div class="ctrl-bot">','<div class="ctrl-m">','<div class="ctrl-c">','<div class="ctrl-scheduleBox" data-ctrl="scroll-track">','<div class="ctrl-scrollbg"></div>','<div class="ctrl-scrollbtn" data-ctrl="scroll-thumb" style="width:0;">','<span class="ctrl-circle" data-ctrl="scroll-corner"></span>',"</div>","</div>","</div>","</div>",'<div class="ctrl-l">','<div class="ctrl-btn"><a class="ctrlplay" href="#" data-btn="ctrlbtn"></a></div>','<div class="ctrl-split"></div>','<div class="ctrl-time" data-text="current">00:00:00</div>',"</div>",'<div class="ctrl-r">','<div class="ctrl-btn"><a class="ctrlscreen" href="#" data-btn="fullscreen"></a></div>','<div class="ctrl-time" data-text="duration">00:00:00</div>',"</div>","</div>","</div>"].join(""));t.push("</div>");if(lib.$("#"+e.wrapper)){lib.$("#"+e.wrapper).html(t.join(""))}},_loadHtml5video:function(e){var t=lib.$("#video");if(e.bits){t.attr("bits",e.bits)}var r="";try{r=window.info.ipad.time^1711192131}catch(i){r=""}t[0].src=e.url+"?v="+r;if(t){t[0].load();lib.action.html5VV();if(info.ipad&&info.ipad.logo==1){this._createWatermark()}}},_createWatermark:function(){var e=lib.$("#ipadwatermark");if(e){e[0].parentNode.removeChild(e[0])}var t=lib.$("#video");var r=lib.Element.create("div");r.attr("id","ipadwatermark");r.css("position","absolute");r.css("zIndex","10");r.css("overflow","hidden");r.pos({top:t.box().top+80,left:t.box().right-91-20});r.html('<img src="http://www.qiyipic.com/common/fix/ipadwatermark.png"/>');lib.$(document.body).append(r)},_getQiyi:function(e,t){e.wrapper=e.wrapper||"flashbox";var r=this._getVid(e);var i=this._getTvId(e);var a="http://cache.video.qiyi.com/m/";lib.kit.util.jsLoad.request(a,{CACHE:{tvId:i,vid:r,varname:"ipadUrl"},onSuccess:function(e){t(e)},onError:function(t){if(t&&t.code=="Q00201"){lib.$("#"+e.wrapper).html("对不起，此视频因版权方的要求，暂时只支持在PC上播放。")}else if(t&&t.code=="Q00202"){var r=setTimeout(function(){clearTimeout(r);if(lib._PAGE_EVENT.handlers["videoUnder"]){lib._PAGE_EVENT.fire({type:"videoUnder",target:{data:{cid:t.data.categoryId,container:lib.$("#"+e.wrapper)}}})}else{r=setTimeout(arguments.callee,100)}},100)}else{lib.$("#"+e.wrapper).html("对不起，此视频暂时不支持您的设备观看。")}lib.$("#"+e.wrapper).css("color","#fff");lib.$("#"+e.wrapper).css("font-size","16px")}})},_getVip:function(e,t){e.wrapper=e.wrapper||"flashbox";var r=info.albumId;var i="afbe8fd3d73448c9";var a=this._getVid(e);var n=(new Date).getTime()+"";var o=parseInt(n.substring(0,2))*parseInt(n.substring(n.length-3))+100;lib.kit.util.jsLoad.request(authUrl,{GET:{aid:r,platform:"b85da1cf3ae44351",cid:i,vid:a,ut:n,utt:o,v:lib.md5([r,i,a,n,o,"2385461878"].join("_")),cb:"cb_"+Math.floor(Math.random()*2147483648).toString(36)},onSuccess:function(e){t({url:"http://cache.vip.iqiyi.com/m/u/"+a+"/"+i+"/"+e.t+"/"+e.pt+".m3u8"})},onError:function(e){}})},_getVid:function(e){if(e.flashVars&&e.flashVars.indexOf("vid=")!==-1){var t=e.flashVars;var r=t.indexOf("vid=")+4;var i=t.indexOf("&",r);var a=t.substring(r,i);var n=a||info.videoId}else{var n=info.videoId}return n},_getTvId:function(e){var t="";if(e.flashVars&&e.flashVars.toLowerCase().indexOf("tvid=")!==-1){t=e.flashVars.match(/tvid=(.*?)&/i)[1]}else{t=info.tvId}return t},_getMp4:function(e,t,r){if(e.mp4Url){lib.kit.util.jsLoad.request(e.mp4Url,{CACHE:{varname:"videoUrl"},onSuccess:r,onError:function(e){lib.$("#"+t.wrapper).html("对不起，此视频暂时不支持您的设备观看。");lib.$("#"+t.wrapper).css("color","#fff");lib.$("#"+t.wrapper).css("font-size","16px")}})}else{lib.$("#"+t.wrapper).html("对不起，此视频暂时不支持您的设备观看。");lib.$("#"+t.wrapper).css("color","#fff");lib.$("#"+t.wrapper).css("font-size","16px")}},_streamSelect:function(e,t,r){var i=t.s+"";var a=e.mtl||[];var n;var o;var s;e.mtl.each(function(e){switch(e.vd){case 1:o=e.m3u;break;case 2:n=e.m3u;break;case 96:s=e.m3u;break}});n=n||e.url;var l=t.l.replace("v.ts","speed_test.png");switch(i){case"2":this._speedTest(l,function(e){if(e>40){r(o||n)}else{r(s||o||n)}});break;case"3":case"4":r(s||o||n);break;default:this._speedTest(l,function(e){if(e>100){r(n)}else if(e<40){r(s||o||n)}else{r(o||n)}})}},_speedTest:function(e,t){var r;var i=5e3;var a=0;var n;if(!e){t(1e3)}else{var o=new Image;o.onload=function(){o.onload=null;n=new Date*1-n;if(!a){clearTimeout(r);var e=parseInt(300/(n/1e3));lib.kit.slog.log({flag:"html5speedstatsfrmsk",speed:e},"http://msg.71.am/tmpstats.gif");t(e)}};n=new Date*1;r=setTimeout(function(){a=1;lib.kit.slog.log({flag:"html5speedstatsfrmsk",speed:"timeout"},"http://msg.71.am/tmpstats.gif");t(1);clearTimeout(r)},i);o.src=e+"?r="+Math.random()}},detectFlashVer:function(e,t,r){var i=this.getSwfVer(),a,n,o;t=t||"0";r=r||"0";if(i==-1){return false}else if(i!=0){if(lib.IE&&isWin&&!lib.OPERA){a=i.split(" ");n=a[1];o=n.split(".")}else{o=i.split(".")}var s=parseFloat(o[0]);var l=parseFloat(o[1]);var c=o[2];if(s>parseFloat(e)){return true}else if(s==parseFloat(e)){if(l>parseFloat(t))return true;else if(l==parseFloat(t)){if(c>=parseFloat(r))return true}}return false}},render:function(){if(!window.checkPlayerVersion){lib._PAGE_EVENT.on("swf_playerLoadSuccess",function(){var e=document.getElementsByTagName("object");var t=document.getElementsByTagName("embed");var r=function(e){if(e.openWindowFail){var t={flashPlayer4_0_test:location.href};lib.kit.slog.log(t,"http://mt.t.iqiyi.com/pingback");return true}};var i,a;for(i=0;i<e.length;i++){if(r(e[i])){a=1;break}}if(!a){for(i=0;i<t.length;i++){if(r(t[i])){break}}}});window.checkPlayerVersion=true}var e=this.AC_GetArgs(arguments,"");if(e&&e.embedAttrs&&e.embedAttrs.src&&e.embedAttrs.src.match(/qiyi_n_player\.swf$/)){var t=parseInt(Math.random()*100);if(t>90)lib.kit.slog.log({flag:"hasplayer"})}if(e.embedAttrs.ipad&&(lib.ipad||lib.noFlashAndroid)){return this.html5video(e.embedAttrs)}if(e.embedAttrs.iPadLive){return this._renderHtml5Live(e.embedAttrs)}if(!this.detectFlashVer(10,0,0)&&e.embedAttrs.hint){if(!isWin){document.write("你需要升级FLASH播放器版本至10.0+,请<a href='http://get.adobe.com/flashplayer/otherversions/' style='color:#6C6C6C;text-decoration:underline;' target='_blank'>下载</a>")}else{if(lib.IE){document.write("你需要升级FLASH播放器版本至10.0+,请<a style='color:#6C6C6C;text-decoration:underline;' href='http://www.adobe.com/go/getflash' target='_blank'>下载</a>")}else{document.write("你需要升级FLASH播放器版本至10.0+,请<a href='http://www.adobe.com/go/getflash' style='color:#6C6C6C;text-decoration:underline;' target='_blank'>下载</a>")}}return false}if(e.isPopup!="true"){lib.$(window).on("beforeunload",function(){var t=lib.$("#"+e.objAttrs.id);if(t&&t[0].windowClose){try{t[0].windowClose()}catch(r){}}})}return this.AC_Generateobj(e.objAttrs,e.params,e.embedAttrs,e.isStr,e.nocache)},_renderHtml5Live:function(e){e=e||{};this._renderVideo(e);var t=e.src||"http://m3u8.live.video.qiyi.com/tslive/CCTV-1/CCTV-1.flv";var r=this;var i="http://data.video.qiyi.com/v.ts";var a=e.wrapper||"flashbox";lib.kit.util.jsLoad.request(i,{CACHE:{varname:"videoUrl"},onSuccess:function(e){if(typeof e.l=="undefined"||e.l==""){lib.$("#"+a).html("对不起，此视频暂时不支持您的设备观看。");lib.$("#"+a).css("color","#fff");lib.$("#"+a).css("font-size","16px");return}if(e.t.match(/oversea/gi)){lib.$("#"+a).html(["由于版权受限，您访问的视频只能在中国大陆范围内观看！","<br/>",'<span style="font-size:12px">',"如果您所在区域为中国大陆，",'<a href="http://www.qiyi.com/common/helpandsuggest.html?entry=banquan" target="_blank" class="fWhite">',"请告知我们","</a> 我们将尽快查找原因。"].join(""));lib.$("#"+a).css("color","#fff");lib.$("#"+a).css("font-size","16px");return}lib.kit.util.jsLoad.request(t,{CACHE:{varname:"videoUrl"},onSuccess:function(e){var t=e.l.replace(/[^\.]*$/,"m3u8");r._loadHtml5video({url:t});try{lib.action.html5LiveVV()}catch(i){}}})},onError:function(t){lib.$("#"+e.wrapper).html("对不起，此视频暂时不支持您的设备观看。");lib.$("#"+e.wrapper).css("color","#fff");lib.$("#"+e.wrapper).css("font-size","16px")}})},_playersID:[],renderPlayer:function(){this.render.apply(this,arguments);var e=this.AC_GetArgs(arguments,"");var t=e.objAttrs.id;var r=document.getElementById(t);if(r&&r.play||r&&r.playQiyiVideo){this._players.push(t)}},getPlayersID:function(){return this._playersID},AC_GetArgs:function(e){var t={};t.embedAttrs={};t.params={};t.objAttrs={};for(var r=0;r<e.length;r=r+2){var i=e[r].toLowerCase();switch(i){case"src":t.embedAttrs["src"]=e[r+1];t.params["movie"]=e[r+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"id":t.objAttrs[e[r]]=e[r+1];t.embedAttrs[e[r]]=e[r+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"tabindex":t.embedAttrs[e[r]]=t.objAttrs[e[r]]=e[r+1];break;case"isstr":t.isStr=e[r+1];break;case"ispopup":t.isPopup=e[r+1];break;case"nocache":t.nocache=e[r+1];break;default:t.embedAttrs[e[r]]=t.params[e[r]]=e[r+1]}}return t},AC_Generateobj:function(e,t,r,i,a){var n=[];if(lib.IE&&isWin&&!lib.OPERA){n.push('<object codebase="'+lib.SITE_PROTOCOL+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0"');n.push('classid ="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"');for(var o in e){n.push(o+'="'+e[o]+'" ')}n.push(">");n.push('<param name="quality" value="high" /> ');n.push('<param name="loop" value="true" /> ');n.push('<param name="play" value="true" /> ');n.push('<param name="DeviceFont" value="false" /> ');n.push('<param name="allowFullScreen" value="true" /> ');n.push('<param name="menu" value="true" /> ');for(var o in t){if((lib.TT||lib.$360||lib.Maxthon)&&o.match(/src|movie/)){t[o]+=!a?"?"+Math.random():""}n.push('<param name="'+o+'" value="'+t[o]+'" /> ')}n.push('<param name="allowScriptAccess" value="always" /> ');n.push("</object>")}else{n.push('<embed pluginspage="http://www.macromedia.com/go/getflashplayer" ');if(lib.winXP&&lib.ff){n.push('style="outline: none;" ')}n.push('loop = "true"');n.push('play = "true"');n.push('quality = "hight"');n.push('scale = "showall"');n.push('DeviceFont= "false"');n.push('allowFullScreen="true"');n.push('menu="true"');n.push('type="application/x-shockwave-flash"');for(var o in r){n.push(o+'="'+r[o]+'" ')}n.push('allowScriptAccess="always"');n.push("> </embed>")}if(i){return n.join("")}document.write(n.join(""))}};Object.extend(window,{GetSwfVer:video.getSwfVer.bind(video),AC_FL_RunContent:video.render.bind(video),DetectFlashVer:video.detectFlashVer.bind(video),AC_Generateobj:video.AC_Generateobj.bind(video)});window.videoPlayStart=function(){if(lib._PAGE_EVENT)lib._PAGE_EVENT.fire({type:"videoPlayStart",target:arguments})};window.videoPlayEnd=function(){if(lib._PAGE_EVENT)lib._PAGE_EVENT.fire({type:"videoPlayEnd",target:arguments})};if(lib._PAGE_EVENT){lib._PAGE_EVENT.on("videoPlayStart",function(){var e=document.getElementById("flash");if(e){if(e.setVisits){var t=lib.cookie.get("QC008"),r;t=t.split(".");r=t.length;e.setVisits([t[1],".",t[r-1]].join(""))}if(e.setNextVideoId){var i=new lib.kit.Monitor(function(){if(!lib.action.customPlay||!lib.action.customPlay.nextInfo.initNextVideoEnd){return false}try{if(lib.action.customPlay.nextInfo.vid){e.setNextVideoId(lib.action.customPlay.nextInfo.vid)}}catch(t){}lib.kit.FlashCall({flashID:"flash",functionName:"notice",parameter:"{type:'setNextInfo',data:{vid:'"+lib.action.customPlay.nextInfo.vid+"',videoName:'"+lib.action.customPlay.nextInfo.videoName+"'}}"})},{maxTime:3e4});i.start()}}})}lib._PAGE_EVENT.on("swf_download",function(e){var e=e.data||{};if(e.albumId&&e.videoName&&e.isCharge&&e.tvid){var t="qisu://albumId="+e.albumId+";tvname="+encodeURIComponent(encodeURIComponent(e.videoName))+";isCharge="+e.isCharge+";tvid="+e.tvid+";offline=true";window.location.href=t}});lib.swf.playerisready=false;lib._PAGE_EVENT.on("swf_playerStateChange",function(e){e=e||{};e.data=e.data||{};var t=(e.data.state||"").toLocaleLowerCase();if(t=="startplay"){var r=lib.$("#flash");if(r){var i=lib.cookie.get("QC008"),a;i=i.split(".");a=i.length;lib.kit.FlashCall({flashID:"flash",functionName:"setQiyiVisits",parameter:[i[1],".",i[a-1]].join("")});var n=r[0].getQiyiVideoInfo();var e=n?JSON.parse(n.replace(/\r/g,"").replace(/\n/g,"")):"";if(e){(function(e,t,r){lib._PAGE_EVENT.fire({type:"videoPlayStart",target:arguments})})(e.vid,e.an,e.tvid)}}}if(t=="dataready"){if(window.Q&&Q.player&&Q.player.demandPb){Q.player.demandPb()}}if(t=="ready"){lib.swf.playerisready=true}if(t=="playing"){lib._PAGE_EVENT.fire({type:"player_playing",data:e})}if(t=="stoped"){lib._PAGE_EVENT.fire({type:"player_stoped",data:e})}if(t=="pause"){lib._PAGE_EVENT.fire({type:"player_pause",data:e})}});window.isRecharge={needCharge:false};lib._PAGE_EVENT.on("swf_recharge",function(e){e=e||{};e.data=e.data||{};var t=e.data.code;window.isRecharge={needCharge:true,code:t}});lib.cookie=lib.cookie||{};lib.cookie.remove=function(e,t,r,i){document.cookie=e+"=;"+"expires=Fri, 31 Dec 1999 23:59:59 GMT;"+"path="+(t||"/")+";"+"domain="+r};lib.cookie.get=function(e){e=e.replace(/([\.\[\]\$])/g,"\\$1");var t=new RegExp(e+"=([^;]*)?;","i");var r=document.cookie+";";var i=r.match(t);if(i){if(i.length>1&&i[1]=="deleted"){return""}else{return decodeURIComponent(i[1])||""}}else{return""}};lib.cookie.set=function(e,t,r,i,a,n){var o=[];o.push(e+"="+encodeURIComponent(t));if(r){var s=new Date;var l=s.getTime()+r*36e5;s.setTime(l);o.push("expires="+s.toGMTString())}if(i){o.push("path="+i)}if(a){o.push("domain="+a)}if(n){o.push(n)}document.cookie=o.join(";")};(function(e,t,r){e.lib=e.lib||{};lib.find=function(e,r){if(typeof e=="object"){if(e._els){return[e._els[0]]}if(e.getAttribute){return[e]}return null}var a=/(#[\w-_]+)?([\w-_*]+)?(\.[\w-_]+)?(\s+.+)?(\[\w(=\w)?])?/i,n="*",o={},r=r||t.body,s=e.match(a);if(!s){return null}o={id:s[1],tag:s[2],cls:s[3],child:s[4]?s[4].replace(/(^[\s\n]+|[\s\n]+$)/g,""):""};e=e.replace(/(^[\s\n]+|[\s\n]+$)/g,"");var l=/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/;var c=e.match(l);if(c&&c.length>0){return i(e,r)}if(o.child){var u=lib.find(e.split(" ")[0],r),f=[];if(u.length){for(var d=0,p=u.length;d<p;d++){var h=lib.find(o.child,u[d]);if(h.length){for(var m=0,v=h.length;m<v;m++){f.push(h[m])}}if(h.innerHTML){f.push(h)}}}if(u.innerHTML){f.push(u)}return f.length>0?f:null}if(o.id){if(o.child){return lib.find(child,lib.find(o.id))}else{var g=t.getElementById(o.id.replace("#",""));return g?[g]:null}}if(o.tag){n=o.tag;if(!o.cls){var b=r.getElementsByTagName(n),_=[];if(b){for(var m=0,v=b.length;m<v;m++){_.push(b[m])}return _}else{return null}}}if(o.cls){var w=lib.find(n,r),f=[];if(w){var y=new RegExp("(^| )"+o.cls.replace(".","")+"( |$)");for(var d=0,p=w.length;d<p;d++){if(w[d].className.match(y)){f.push(w[d])}}return f}return null}};function i(e,r){var i=Object.prototype.toString;var n={querySelector:!!t.querySelectorAll};var o=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,s=[],l,c={ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/},u={attr:function(e,t){var r=[],i=e.match(c.ATTR),a=e.slice(0,e.indexOf("[")),n=t.getElementsByTagName(a);for(var o=0,s=n.length;o<s;o++){if(n[o].getAttribute(i[1])&&(n[o].getAttribute(i[1])==i[4]||i[4]=="")){r.push(n[o])}}return r},filter:function(e,t){var r=[];for(var i=0;i<e.length;i++){if(t.contains(e[i])){r.push(e[i])}}return r.length==0?null:r}};if(n.querySelector){s=t.querySelectorAll(e);if(r){s=u.filter(s,lib.$(r))}}else{var f=e.match(o);if(f.length==1){s=u.attr(e,r||t)}else{s=u.attr(f[1],t.getElementById(f[0].slice(1)))}}return i.call(s)=="[object Array]"?s:a(s)}function a(e){if(!e)return;var t=[],r=e.length;for(var i=0;i<r;i++){t[i]=e[i]}return t}})(window,document);(function(e,t,r){var i=Array.prototype;lib.each({each:function(e){this.forEach(e);return this},include:function(e){return this.index(e)!=-1},index:function(e){for(var t=0,r=this.length;t<r;t++){if(this[t]==e){return t}}return-1},unique:function(){for(var e=0;e<this.length;e++){var t=this[e];for(var r=this.length-1;r>e;r--){if(this[r]==t)this.splice(r,1)}}return this},del:function(e){var t=this.index(e);if(t>=0&&t<this.length){this.splice(t,1)}return this},insert:function(e,t){return this.slice(0,e).concat(t,this.slice(e))},remove:function(e){var t=this.slice(0,e);var r=this.slice(e+1);return t.concat(r)},indexOf:function(e,t){t||(t=0);var r=this.length;if(t<0)t=r+t;for(;t<r;t++)if(this[t]===e)return t;return-1},lastIndexOf:function(e,t){t=isNaN(t)?this.length:(t<0?this.length+t:t)+1;var r=this.slice(0,t).reverse().indexOf(e);return r<0?r:t-r-1},every:function(e){var t=this.length;if(typeof e!="function")throw new TypeError;var r=arguments[1];for(var i=0;i<t;i++){if(i in this&&!e.call(r,this[i],i,this))return false}return true},filter:function(e){var t=this.length;if(typeof e!="function")throw new TypeError;var r=new Array;var i=arguments[1];for(var a=0;a<t;a++){if(a in this){var n=this[a];if(e.call(i,n,a,this))r.push(n)}}return r},forEach:function(e){var t=this.length;if(typeof e!="function")throw new TypeError;for(var r=0;r<t;r++){if(r in this)e(this[r],r)}},map:function(e){var t=this.length;if(typeof e!="function")throw new TypeError;var r=new Array(t);var i=arguments[1];for(var a=0;a<t;a++){if(a in this)r[a]=e.call(i,this[a],a,this)}return r},some:function(e){var t=this.length;if(typeof e!="function")throw new TypeError;var r=arguments[1];for(var i=0;i<t;i++){if(i in this&&e.call(r,this[i],i,this))return true}return false},last:function(){var e=this.length;return e>0?this[e-1]:null}},function(e,t){if(!lib.isNative(i[t])){i[t]=e}})})(window,document);(function(e,t,r){var i=Object.prototype.hasOwnProperty;lib.each({each:function(e,t,r){if(typeof t!="function")throw new TypeError;for(var a in e){if(i.call(e,a))t.call(r,e[a],a,e)}},subset:function(e,t){var r={};for(var i=0,a=t.length;i<a;i++){var n=t[i];if(n in e)r[n]=e[n]}return r},map:function(e,t,r){if(typeof t!="function")throw new TypeError;var a={};for(var n in e){if(i.call(e,n))a[n]=t.call(r,e[n],n,e)}return a},filter:function(e,t,r){if(typeof t!="function")throw new TypeError;var a={};for(var n in e){var o=e[n];if(i.call(e,n)&&t.call(r,o,n,e))a[n]=o}return a},every:function(e,t,r){if(typeof t!="function")throw new TypeError;for(var a in e){if(i.call(e,a)&&!t.call(r,e[a],a))return false}return true},some:function(e,t,r){if(typeof t!="function")throw new TypeError;for(var a in e){if(i.call(e,a)&&t.call(r,e[a],a))return true}return false},keys:function(e){var t=[];for(var r in e){if(i.call(e,r))t.push(r)}return t},values:function(e){var t=[];for(var r in e){if(i.call(e,r))t.push(e[r])}return t},getLength:function(e){return Object.keys(e).length},keyOf:function(e,t){for(var r in e){if(i.call(e,r)&&e[r]===t)return r}return null},contains:function(e,t){return Object.keyOf(e,t)!=null}},function(e,t){if(!lib.isNative(Object[t])){Object[t]=e}})})(window,document);lib.box=lib.box||{version:"1.0.0",toString:function(){return"[Object lib.box(version "+this.version+")]"}};Object.extend(lib.box,{getDocumentHeight:function(e){e=e||window;var t=e.document;var r=t.compatMode!="CSS1Compat"?t.body.scrollHeight:t.documentElement.scrollHeight;var i=Math.max(r,this.getViewportHeight(e));return i},getDocumentWidth:function(e){e=e||window;var t=e.document;var r=t.compatMode!="CSS1Compat"?t.body.scrollWidth:t.documentElement.scrollWidth;var i=Math.max(r,this.getViewportWidth(e));return i},getViewportHeight:function(e){e=e||window;var t=e.document;var r=t.documentElement;return e.innerHeight||r&&r.clientHeight+(r.style.borderTopWidth==""?0:r.style.borderTopWidth)+(r.style.borderBottomWidth==""?0:r.style.borderBottomWidth)||t.body.clientHeight},getViewportWidth:function(e){e=e||window;var t=e.document;var r=t.documentElement;return e.innerWidth||r&&r.clientWidth+(r.style.borderLeftWidth==""?0:r.style.borderLeftWidth)+(r.style.borderRightWidth==""?0:r.style.borderRightWidth)||t.body.clientWidth},getPageScrollTop:function(e){e=e||window;var t=e.document;var r=t.documentElement;return e.pageYOffset||r&&r.scrollTop||t.body.scrollTop},getPageScrollLeft:function(e){e=e||window;var t=e.document;var r=t.documentElement;return e.pageXOffset||r&&r.scrollLeft||t.body.scrollLeft},getPosition:function(e){try{var t=e.getBoundingClientRect()}catch(r){lib.log("getPosition failed.");return{top:9999,left:9999}}var i=e.ownerDocument,n=i.body,a=i.documentElement,o=a.clientTop||n.clientTop||0,s=a.clientLeft||n.clientLeft||0,l=t.top+(self.pageYOffset||a.scrollTop||n.scrollTop)-o,c=t.left+(self.pageXOffset||a.scrollLeft||n.scrollLeft)-s;return{top:l,left:c}}});Object.extend(Date.prototype,{format:function(e){var t=this;var r=t.getFullYear();var i=t.getMonth()+1;i=i>9?i:"0"+i;var a=t.getDate()>9?t.getDate():"0"+t.getDate();var n=t.getHours()>9?t.getHours():"0"+t.getHours();var o=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();var s=t.getSeconds()>9?t.getSeconds():"0"+t.getSeconds();return e.replace(/(y{2,4})/,r).replace("MM",i).replace("dd",a).replace("hh",n).replace("mm",o).replace("ss",s)}});lib.date={};Object.extend(lib.date,{getHours:function(e){var t=e>3600?Math.floor(e/3600):0;var r=e%3600>60?Math.floor(e%3600/60):0;r=r>=10?r:"0"+r;var e=r>0?e%3600%60:e;e=e>=10?e:"0"+e;return t>0?(t>9?t:"0"+t)+":"+r+":"+e:r+":"+e},formatTime:function(e,t){e=parseInt(e);var r=Math.floor(e/3600);var i=Math.floor((e-r*3600)/60);var a=e-r*3600-i*60;var n=0;if(t.indexOf("d")==0){n=Math.floor(r/24);r=r%24;return{d:n,h:r,m:i,s:a}}else{return{h:r,m:i,s:a}}},isLeap:function(e){return e%400?e%100?e%4?false:true:false:true},toSecond:function(e){var t=e.split(":");var r=0,i=t.length;for(var a=0;a<i;a++){r+=Math.pow(60,i-1-a)*parseInt(t[a])}return r}});$reg("lib.net",function(){lib.net.Ajax={request:function(e,t){var r=this._getTransport();t=Object.extend({method:"get",async:true},t||{});if(t.method=="get"&&typeof t.data=="string"&&t.data.length>0){e+=(e.indexOf("?")==-1?"?":"&")+t.data;t.data=null}r.open(t.method,e,t.async);if(t.method=="post"){r.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8")}r.onreadystatechange=this._onStateChange.bind(this,r,e,t);r.send(t.data||null);return r},text:function(e,t){t.format="text";return this.request(e,t)},json:function(e,t){t.format="json";return this.request(e,t)},xml:function(e,t){t.format="xml";return this.request(e,t)},_getTransport:function(){if(window.XMLHttpRequest)return new XMLHttpRequest;else{try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return false}}}},_onStateChange:function(trans,url,options){if(trans.readyState==4){trans.onreadystatechange=function(){};var s=trans.status;if(typeof s=="number"&&s>=200&&s<300){if(typeof options.success!="function")return;var ctt=trans;if(typeof options.format=="string"){switch(options.format){case"text":ctt=trans.responseText;break;case"json":try{ctt=eval("("+trans.responseText+")")}catch(e){if(window.console&&console.error)console.error(e)}break;case"xml":ctt=trans.responseXML;break}}options.success(ctt)}else{if(window.closed)return;if(typeof options.failure=="function"){var error={status:trans.status,statusText:trans.statusText};if(trans.readyState==4&&(trans.status==0||trans.status==12030)){error.status=-1}options.failure(error)}}}}};lib.net.loadCSS=function(e){if(!e){return}var t=document.getElementsByTagName("head"),r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href",e);t&&t[0].appendChild(r)};lib.net.SUCCESS="A00000";lib.net.jsLoad=function(e){var t=Object.extend({url:"",onComplete:function(){},onError:function(){},charset:false,doc:document,timeout:1e4},e),r=false,i=false,n=t.doc.createElement("script");n.language="javascript";n.type="text/javascript";t.charset&&(n.charset=t.charset);n.onload=n.onreadystatechange=function(){if(i)return;if(!n.readyState||"loaded"==n.readyState||"complete"==n.readyState){r=true;t.onComplete();n.onload=n.onreadystatechange=null}};setTimeout(function(){if(!r){i=true;t.onError()}},t.timeout);n.src=t.url;document.getElementsByTagName("head")[0].appendChild(n)};lib.getPath=function(e){var t={js:lib.PROJECT_BASE_PATH||"http://static.qiyi.com/js/qitan/"};if(!t.js)t.js="";var r=t.js.substr(t.js.length-1,1),i=e.trim().toLowerCase();return t.js+(r=="/"?"":"/")+i.split(".").join("/")+".js"};lib._loadQueue={_queue:[],enqueue:function(e){this._queue.push(e)},dequeue:function(){return this._queue.splice(0,1)},get:function(){return this._queue[0]},isEmpty:function(){return this._queue.length===0}};lib._loadStack={_stack:[],_loaded:{},_running:false,start:function(){if(!this._running){this.pull()}},push:function(e){this._stack.push(e)},pull:function(){this._running=true;if(this._stack.length==0){lib._loadQueue.dequeue();if(lib._loadQueue.isEmpty()){this._running=false;return}this.push(lib._loadQueue.get())}var e=this._stack[this._stack.length-1];if(e.scripts.length==0){if(e.fn){e.fn()}this._stack.splice(this._stack.length-1,1);this.pull();return}var t=e.scripts.shift();if(!this._loaded[t.toLowerCase()]){this._loaded[t.toLowerCase()]=true;var r=lib.getPath(t);var i=this;lib.net.jsLoad({url:r,onComplete:function(){i.pull()},onError:function(){}})}else{this.pull()}}};lib.require=function(){var e,t,r;if(arguments.length==2){e=arguments[0];t=arguments[1]}else if(arguments.length==3){e=arguments[0];r=arguments[1];t=arguments[2]}else{e=arguments[0]}t=t||function(){};var i=e?e.split(","):[];var n={scripts:i,fn:t};if(r){if(lib._loadQueue.isEmpty()){lib._loadStack.push(n)}lib._loadQueue.enqueue(n)}else{lib._loadStack.push(n)}lib._loadStack.start()}});lib.reg=$reg;window.Ijax=lib.net.Ijax={arrTaskLists:[],createLoadingIframe:function(){var e=this;if(this.loadFrames!=null){return false}var t="loadingIframe_thread"+Math.ceil(Math.random()*1e4);this.loadFrames=t;var r=['<iframe id="'+t+'" name="'+t+'" class="invisible"',' scrolling="no" src="'+lib.SITE_PROTOCOL+"www."+lib.SITE_DOMAIN+'/common/crosspost.html"',' allowTransparency="true" style="display:none;" frameborder="0"'," ></iframe>"].join("");var i=document.createElement("div");i.id="ijax_iframes";i.innerHTML=r;document.body.appendChild(i);if(document.getElementById(e.loadFrames)!=null){loadTimer=null;e.loadingIframe={container:document.getElementById(e.loadFrames),isBusy:false};e.loadByList()}},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}if(this.loadingIframe.isBusy==false){this.loadingIframe.isBusy=true;return this.loadingIframe}return false},request:function(e,t){var r={};r.url=e;r.option=t||{};this.arrTaskLists.push(r);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var e=this.isIjaxReady();if(e==false){return false}var t=this.arrTaskLists[0];var r=this;setTimeout(function(){r.loadData(t.url,t.option,e)},10);this.arrTaskLists.shift()},destory:function(){if(this.arrTaskLists.length>0)return;document.getElementById(this.loadFrames).callback=null;document.body.removeChild(document.getElementById("ijax_iframes"));if(document.getElementById("IjaxForm")){document.getElementById("IjaxForm").action="";document.getElementById("IjaxForm").target="";document.body.removeChild(document.getElementById("IjaxForm"))}this.loadFrames=null},loadData:function(url,option,loader){var ifm=loader.container;var _self=this,_url="";var timeouted=false;var unTimeout=false;var timeoutID;var newTimeoutID;ifm.callback=function(res){unTimeout=true;if(timeouted){return}res=typeof res=="string"&&/\s*{/.test(res)?eval("("+res+")"):res;if(res.code=="A00000"&&option.onSuccess){option.onSuccess(res.data);_self.destory()}else{option.onError(res);_self.destory()}loader.isBusy=false;_self.loadByList()};if(!isNaN(option.timeout)){timeoutID=setTimeout(function(){if(unTimeout){return}timeouted=true;option.onError();_self.destory()},option.timeout)}if(option.CACHE){_url=url;for(var key in option.CACHE){_url+=option.CACHE[key]+"/"}if(option.spliter==="0"){_url=_url.slice(0,-1)}}else{_url=new lib.kit.Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,encodeURIComponent(option.GET[key]))}}if(option.POST){var correctArea=window.correctArea||{};var ip=correctArea.ip&&correctArea.ip.html()||"none";if(!document.getElementById("IjaxForm")){var oIjaxForm=document.createElement("form");document.body.appendChild(oIjaxForm);oIjaxForm.id="IjaxForm";oIjaxForm.method="post";oIjaxForm.target=ifm.id}else{document.getElementById("IjaxForm").innerHTML=""}document.getElementById("IjaxForm").action=_url;for(var oItem in option.POST){var oInput=document.createElement("input");oInput.type="hidden";oInput.name=oItem;oInput.value=option.POST[oItem];document.getElementById("IjaxForm").appendChild(oInput)}newTimeoutID=setTimeout(function(){clearTimeout(newTimeoutID);if(ifm.readyState=="complete"||!lib.IE){document.getElementById("IjaxForm").submit()}else{newTimeoutID=setTimeout(arguments.callee,100)}},100)}}if(!option.POST)ifm.contentWindow.location.replace(_url)}};lib.net.crossDomain={Request:function(e,t){var r="cb_";this._url=e;this.option={prefix:r,charset:"utf-8",queryField:"cb",callbackName:r+Math.floor(Math.random()*2147483648).toString(36),timeout:1e4,spliter:"1"};Object.extend(this.option,t);this._getParams=function(){var e="t="+(new Date).getTime();return this.option.data==""?e:this.option.data+"&"+e};this.get=function(){var e=this.option.prefix,t=this.option.queryField;var r=this.option.callbackName;var i=this._url+"?"+t+"="+r+"&"+this._getParams();var n=this;lib.net.jsLoad({timeout:this.option.timeout,url:i,onComplete:function(){if(!!window[r]){try{n.option.success.apply(window,[window[r]])}finally{try{if(!delete window[r]){window[r]=null}}catch(e){}}}},onError:function(){}})};this.post=function(){var e=this,t=this.option.data;t[this.option["queryField"]]=this.option.callbackName;lib.net.Ijax.request(this._url,{onSuccess:function(t){e.option.success.apply(window,[{code:"A00000",data:t}])},onError:function(t){e.option.failure.apply(window,[t])},POST:t,timeout:this.option["timeout"]})}},request:function(e,t){var r=this;var i=t.method.toLowerCase();var n=new lib.net.crossDomain.Request(e,t);if(i=="get"){n.get()}if(i=="post"){n.post()}},_error:function(){}};lib.net.formRequest={request:function(e,t){this.option=t||{};if(lib.$("#order_form")){var r=lib.$("#order_form")}else{var r=lib.Element.create("form");r.attr("id","order_form");lib.$(document.body).append(r)}r.attr("action",e);r.attr("method",this.option.method||"GET");r.attr("target",this.option.target||"_self");var i=this.option.param||{};for(var n in i){var a=lib.$("#"+n);if(!a||!r.contains(a)){a=lib.Element.create("input");a.attr("type","hidden");a.attr("id",n);a.attr("name",n);r.append(a)}a.val(i[n])}r[0].submit()},_error:function(){}};lib.reg("qitan.model.request",function(){var PACK=qitan.model.request;qitan.model.SUCCESS="A00000";lib.net.isLogin=PACK.isLogin=function(){return lib.cookie.get("P00002")!==""&&lib.cookie.get("P00002")!=="deleted"&&lib.cookie.get("P00003")!==""&&lib.cookie.get("P00003")!=="deleted"};lib.net.getUserInfo=PACK.getUserInfo=function(){var userInfo=lib.cookie.get("P00002");return userInfo==""?"":window.JSON?window.JSON.parse(userInfo):eval("("+userInfo+")")};lib.net.getLoginInfo=function(){return{isLogin:lib.net.isLogin(),uid:lib.net.getUserInfo().uid}};lib.net.showLogin=function(e){e=e||function(){};var t=lib.PROJECT_LOGIN_COMPONENT||qitan.component.login.init;if(t.show){t.show(e)}else{t()}};PACK.core=Class.create({initialize:function(e){this.opt=e;this._initActions()},_initActions:function(){for(var e in this.opt.actions){this[e]=this._action.bind(this,e)}},_action:function(e,t,r){var i=this.opt.actions[e];var n=(this.opt.url||"")+(i.url||"");if(r&&r.url){n=r.url+(i.url||"")}i.data=this._getParams(i,t,n);i.success=this._success.bind(this,i.format,r);i.failure=this._failure.bind(this,r);if(i.passport&&!lib.net.isLogin()){this.__request=this._request.bind(this,n,i);this.__request.isTemp=true;lib.net.showLogin(this.__request);return}this._request(n,i)},_request:function(e,t){var r=null;if(arguments.length>=3&&!!arguments[2].nickname){r=arguments[2];if(t.data.indexOf("userId=undefined")!==-1){t.data=t.data.replace("userId=undefined","userId="+r.uid)}}if(this.isCrossDomain(e)){lib.net.crossDomain.request(e,t)}else{lib.net.Ajax.request(e+"?t="+(new Date).getTime(),t)}},isCrossDomain:function(e){var t=/https?:\/\/(.*?)\//,r=e.match(t)[0],i=location.href.match(t)[0];return this.opt.crossDomain===undefined?r!==i:this.opt.crossDomain},_success:function(e,t,r){if(e=="json"){if(r.code==qitan.model.SUCCESS){if(t.success)t.success(r.data)}else{if(t.failure)t.failure(r)}}else{t.success(r)}},_failure:function(e,t){if(e.failure)e.failure(t)},_getParams:function(e,t,r){var i=this.isCrossDomain(r),n=[],a={};for(var o in t){if(e.params.include(o)){if(!i&&e.encode||i&&e.encode&&e.method=="get"){n.push(o+"="+encodeURIComponent(t[o]))}else{if(i&&e.method=="post"){a[o]=t[o]}else{n.push(o+"="+t[o])}}}}if(i&&e.method=="post"){return a}return n.join("&")}});lib.model=qitan.request=function(e){return new qitan.model.request.core(e)}});(function(e,t,r){var i=String.prototype;lib.each({trimLeft:function(){return this.replace(/^(\u3000|\s|\t)*/gi,"")},trimRight:function(){return this.replace(/(\u3000|\s|\t)*$/gi,"")},trim:function(){return this.trimLeft().trimRight()},trimHtml:function(){return this.replace(/<\/?[^>]+(>|$)/g,"")},format:function(e,t){var r=arguments;return this.replace(/{(\d+)(:([0-9a-z]+))?}/gi,function(){var e=r[parseInt(arguments[1])];if(typeof e==="undefined"){return arguments[0]}return e})},setImgSize:function(e){var t=this.replace(/(.[^.]*$)/,e+"$1");return t},getLen:function(){var e=this;if(typeof e=="undefined"){return 0}var t=e.match(/[^\x00-\x80]/g);return e.length+(!t?0:t.length)},divideNumber:function(){var e=this;var t=Math.ceil(e.length/3);var r="";for(var i=t;i>0;i--){if(e.length-(i-1)*3<=0)left=0;else left=e.length-(i-1)*3;r+=","+e.substring(left,e.length-i*3)}r=r.substring(1,r.length);return r},filter:function(){var e=this;return e.replace(/[^a-z0-9A-Z\u4e00-\u9fa5]/g," ")},trancate:function(e,t){var r=this;if(typeof t=="undefined")t="..";if(r.getLen()<=e){return r}var i=r.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");r=r.slice(0,i.slice(0,e).replace(/\*\*/g," ").replace(/\*/g,"").length);r=r.slice(0,r.length-(t===""?0:1))+t;return r},encodeHtml:function(){return String(this).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},function(e,t){if(!lib.isNative(i[t])){i[t]=e}})})(window,document);(function(){$reg("lib.ui",function(){});lib.ui.viewCenter=function(e,t){t=t||"absolute";if(!e)return;var r=e.offsetWidth,i=e.offsetHeight,n=lib.box.getViewportWidth(),a=lib.box.getViewportHeight();if(!r||!i)throw"zero width or height.";var o={left:(n-r)/2+lib.box.getPageScrollLeft(),top:(a-i)/2+lib.box.getPageScrollTop()};e.style.position=t;$(e).pos(o)}})();if(!window.JSON){window.JSON=window.JSON||{};JSON.parse=function(e){return new Function("return "+e)()};JSON.stringify=function(){var e={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function t(t){if(/["\\\x00-\x1f]/.test(t)){t=t.replace(/["\\\x00-\x1f]/g,function(t){var r=e[t];if(r){return r}r=t.charCodeAt();return"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16)})}return'"'+t+'"'}function r(e){var t=["["],r=e.length,i,n,a;for(n=0;n<r;n++){a=e[n];switch(typeof a){case"undefined":case"function":case"unknown":break;default:if(i){t.push(",")}t.push(JSON.stringify(a));i=1}}t.push("]");return t.join("")}function i(e){return e<10?"0"+e:e}function n(e){return'"'+e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+"T"+i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+'"'}return function(e){switch(typeof e){case"undefined":return"undefined";case"number":return isFinite(e)?String(e):"null";case"string":return t(e);case"boolean":return String(e);default:if(e===null){return"null"}else if(e instanceof Array){return r(e)}else if(e instanceof Date){return n(e)}else{var i=["{"],a=JSON.stringify,o,s;for(key in e){if(e.hasOwnProperty(key)){s=e[key];switch(typeof s){case"undefined":case"unknown":case"function":break;default:if(o){i.push(",")}o=1;i.push(a(key)+":"+a(s))}}}i.push("}");return i.join("")}}}}()}var lib=lib||{};function Jobs(){this._jobTable=[];this._startedjobTable=[]}Jobs.prototype={_registedJobTable:{},_registedJobsTable:{},_orinJobTable:{},initialize:function(){},_registJob:function(e,t){this._registedJobTable[e]=t;this._orinJobTable[e]=t;return this},_registJobs:function(e,t){this._registedJobsTable[e]=t;return this},add:function(e,t){for(var r=0,i=this._jobTable.length;r<i;r++){if(this._jobTable[r]["name"]==e){return this}}for(var r in this._registedJobsTable){if(r==e){for(var n in this._registedJobsTable[r]){this._jobTable.push({name:n,param:t&&t[n]||this._registedJobsTable[r][n]})}return this}}this._jobTable.push({name:e,param:t});return this},start:function(){var e=this._jobTable;var t=this._registedJobTable;while(this._jobTable.length>0){var r=this._jobTable[0].name;var i=this._jobTable[0].param;var n=t[r];if(typeof n=="undefined"){this._jobTable.shift();continue}try{if(this._startedjobTable.indexOf(r)==-1){n.call(null,i);this._startedjobTable.push(r)}this._jobTable.shift();delete this._registedJobTable[r]}catch(a){lib.log("Job["+r+"] failed!!!");_try=false;lib.log("job start  msg: "+a.message);lib.log("job start file: "+a.fileName);lib.log("job start line: "+a.lineNumber);this._jobTable.shift()}}},call:function(e,t){if(typeof this._orinJobTable[e]!="undefined"){this._orinJobTable[e].apply(this,t)}else{lib.log("Job["+e+"] is undefined!!!")}}};$newJob=lib.kit.newJob=function(e,t){Jobs.prototype._registJob(e,t)};$newJobs=lib.kit.newJobs=function(e,t){Jobs.prototype._registJobs(e,t)};lib.kit.$callJob=function(e){var t=[];if(arguments.length>1){arguments.foreach(function(e,r){t[r]=e});t.shift()}Jobs.prototype.call(e,t)};lib._PAGE_JOB=new Jobs;$reg("lib.kit.Monitor",function(){lib.kit.Monitor=Class.create({initialize:function(e,t){this._fn=e;this._opt={time:10,maxTime:null};Object.extend(this._opt,t)},start:function(){var e=this;if(this._opt.maxTime){this._maxTimer=setTimeout(function(){e.stop()},this._opt.maxTime)}this._timer=setTimeout(function(){if(e._fn.call()===false){e._timer=setTimeout(arguments.callee,e._opt.time);return}},this._opt.time)},stop:function(){if(this._timer){clearTimeout(this._timer)}}})});$reg("lib.kit.FlashCall",function(){lib.kit.FlashCall=function(e){e=e||{};var t=$("#"+(e.flashID||"")),r=e.functionName,i=e.parameter,n=e.tryTimes||0,a=e.perTimes||500,o=0,s=e.callback||lib.emptyMethod,l,c;if(!t||!r){return}l=function(){var e;try{if(i===undefined){e=t[0][r]()}else if(Object.prototype.toString.apply(i)=="[object Object]"){e=t[0][r](JSON.stringify(i))}else{e=t[0][r](i)}}catch(n){return false}try{s(e)}catch(n){}return true};(function(){clearTimeout(c);if(!l()){if(!n||o<n){c=setTimeout(arguments.callee,a);o++}return}})()}});lib.swf=lib.swf||{};lib.swf.openWindow=function(e){window.open(e);return true};lib.swf.openAdPostWindow=function(e,t,i,r){if(r!==undefined){var n=new Date;t=t.replace('"ib":"'+r+'"','"ib":"'+String(n.getTime()+Number(r))+'"')}var a=document.createElement("form");a.id="tempForm";a.method="post";a.action=e;a.target="_blank";var o=document.createElement("input");o.type="hidden";o.name="data";o.value=t;a.appendChild(o);document.body.appendChild(a);a.submit();document.body.removeChild(a)};lib.swf.openPostWindow=function(e,t){t=JSON.parse(t);var i=document.createElement("form");i.id="tempForm";i.method="post";i.action=e;i.target="_blank";if(t){for(var r in t){var n=document.createElement("input");n.type="hidden";n.name=r;n.value=t[r];i.appendChild(n)}}document.body.appendChild(i);i.submit();document.body.removeChild(i)};lib._PAGE_EVENT.on("swf_getLoginInfo",function(e){var t=lib.$("#flash");if(t&&t[0]&&!t[0].notice){lib.kit.slog.log({flag:"getLoginInfoErr"})}lib.kit.FlashCall({flashID:"flash",functionName:"notice",parameter:{type:"getLoginInfo",data:{isLogin:lib.net.isLogin(),uid:lib.net.getUserInfo().uid}}})});lib.swf.getCookieLoginState=function(){return JSON.stringify({isLogin:lib.net.isLogin(),uid:lib.net.getUserInfo().uid})};lib.swf.getPageInfo=function(){var e=lib.$("#j-gui-qitan")?"true":"false";var t=lib.net.getUserInfo()||{};var i={canDown:(!!lib.$("#j-offline")).toString(),login:lib.net.isLogin().toString(),passportId:t.uid,comment:e,name:t.nickname,authString:lib.cookie.get("P00001")||""};return JSON.stringify(i)};lib._PAGE_EVENT.on("swf_moveToQitan",function(e){try{lib.swf.scroll2qitan()}catch(t){lib.log("player-api msg: "+t.message);lib.log("player-api file: "+t.fileName);lib.log("player-api line: "+t.lineNumber)}});lib.temp=lib.temp||{};lib.temp.processVBaidu=function(e){var t=lib.$(e.target||e.srcElement);var i=t.parent("a");if(i&&i.attr("target")!="_blank"&&i.attr("href")&&!i.attr("href").match(/#$/)&&!i.attr("href").match(/^javascript\:/)){top.location.href=i.attr("href")}};var url=new lib.kit.Url(location.href);if(url.getParam("pr")=="baidu"){lib.$(document).on("click",lib.temp.processVBaidu)}